<!DOCTYPE html>
<html lang="ru" style="background:#07070f!important;color-scheme:dark!important">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#07070f">
<meta name="color-scheme" content="dark">
<title>INVESTAT Â· ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;600;700;900&family=Manrope:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<script type="module">
  import { initializeApp }
    from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
  import {
    getFirestore, doc, setDoc, getDoc, getDocs,
    collection, onSnapshot, increment, updateDoc,
    deleteDoc, serverTimestamp, arrayUnion, addDoc
  } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

  const firebaseConfig = {
    apiKey:            "AIzaSyBvPOFlJsnO5BNYLdRdA-Db4uvXT8QIwXQ",
    authDomain:        "navigation-a08ba.firebaseapp.com",
    projectId:         "navigation-a08ba",
    storageBucket:     "navigation-a08ba.firebasestorage.app",
    messagingSenderId: "988049632333",
    appId:             "1:988049632333:web:c1049f11704842a3d68004"
  };

  try {
    const app = initializeApp(firebaseConfig);
    const db  = getFirestore(app);

    // Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ² window Ğ´Ğ»Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ² Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ñ… ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ°Ñ…
    window.__FS           = db;
    window.__fsDoc        = doc;
    window.__fsSetDoc     = setDoc;
    window.__fsGetDoc     = getDoc;
    window.__fsGetDocs    = getDocs;
    window.__fsCollection = collection;
    window.__fsOnSnapshot = onSnapshot;
    window.__fsIncrement  = increment;
    window.__fsUpdateDoc  = updateDoc;
    window.__fsDeleteDoc  = deleteDoc;
    window.__fsArrayUnion = arrayUnion;
    window.__fsAddDoc     = addDoc;
    window.__fsTs         = serverTimestamp;
    window.__firebaseReady = true;
    console.log('âœ… Firestore ready');
  } catch(e) {
    console.warn('âŒ Firestore init error:', e.message);
    window.__firebaseReady = false;
  }
</script>

<style>
/* â•â• FORCE DARK â€” kills Telegram light theme â•â• */
:root{color-scheme:dark!important;-webkit-text-size-adjust:100%}
html,body{color-scheme:dark!important;background:#07070f!important;background-color:#07070f!important}
*,*::before,*::after{box-sizing:border-box;-webkit-tap-highlight-color:transparent;margin:0;padding:0}
body *{-webkit-font-smoothing:antialiased}

:root{
  --bg:#07070f;--bg2:#0c0c1a;--bg3:#111122;
  --card:#111122;--card2:#18182a;
  --brd:rgba(255,255,255,0.07);--brd2:rgba(255,255,255,0.12);
  --acc:#3d5af1;--acc2:#6c3de8;--glow:rgba(61,90,241,0.28);
  --grn:#0baa6e;--red:#e03050;--gold:#d4a011;
  --text:#eeeeff;--txt2:#7777aa;--txt3:#3a3a60;
  --tab:62px;
}

html,body{font-family:'Manrope',sans-serif;background:#07070f!important;color:#eeeeff!important;height:100%;overflow:hidden}
.screen{display:none;flex-direction:column;height:100vh;background:#07070f}
.screen.active{display:flex}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUTH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#auth-screen{position:relative;overflow:hidden}
.orb{position:absolute;border-radius:50%;pointer-events:none}
.o1{top:-100px;right:-80px;width:360px;height:360px;background:radial-gradient(circle,rgba(61,90,241,.18)0%,transparent 70%)}
.o2{bottom:-80px;left:-100px;width:300px;height:300px;background:radial-gradient(circle,rgba(108,61,232,.14)0%,transparent 70%)}
.ascroll{position:relative;z-index:1;overflow-y:auto;height:100vh;padding:0 20px 40px;-webkit-overflow-scrolling:touch;background:#07070f}
.alogo{display:flex;flex-direction:column;align-items:center;padding:44px 0 26px}
.aring{width:64px;height:64px;border-radius:18px;background:linear-gradient(135deg,var(--acc),var(--acc2));display:flex;align-items:center;justify-content:center;box-shadow:0 0 40px var(--glow);margin-bottom:14px}
.aname{font-family:'Unbounded',sans-serif;font-size:20px;font-weight:700;color:#eeeeff}
.asub{font-size:12px;color:#7777aa;margin-top:4px}
.seg{display:flex;background:#111122;border-radius:12px;padding:3px;gap:3px;margin-bottom:20px}
.segb{flex:1;padding:10px;border:none;border-radius:9px;background:transparent;color:#7777aa;font-family:'Manrope',sans-serif;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s}
.segb.on{background:linear-gradient(135deg,var(--acc),var(--acc2));color:#fff;box-shadow:0 3px 14px var(--glow)}
.fg{margin-bottom:12px}
.fl{display:flex;align-items:center;gap:5px;font-size:11px;font-weight:700;color:#7777aa;margin-bottom:5px;letter-spacing:.07em;text-transform:uppercase}
.fw{position:relative}
.fi{
  width:100%;padding:13px 44px 13px 42px;
  background:#18182a!important;background-color:#18182a!important;
  box-shadow:inset 0 0 0 1000px #18182a!important;
  border:1.5px solid rgba(255,255,255,0.11);border-radius:11px;
  color:#eeeeff!important;-webkit-text-fill-color:#eeeeff!important;
  font-family:'Manrope',sans-serif;font-size:14px;font-weight:500;
  outline:none;transition:border-color .2s;-webkit-appearance:none!important;caret-color:#3d5af1;
}
.fi:focus{border-color:#3d5af1;box-shadow:inset 0 0 0 1000px #1e1e35!important}
.fi.er{border-color:var(--red)!important}
.fi:-webkit-autofill,.fi:-webkit-autofill:focus{-webkit-text-fill-color:#eeeeff!important;-webkit-box-shadow:0 0 0 1000px #18182a inset!important}
.fi::placeholder{color:#3a3a60!important;-webkit-text-fill-color:#3a3a60!important}
.fico{position:absolute;left:13px;top:50%;transform:translateY(-50%);opacity:.38;display:flex;pointer-events:none;color:#eeeeff}
.feye{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;opacity:.32;display:flex;color:#eeeeff}
.hint{font-size:11px;margin-top:4px;padding-left:2px;display:none}
.hint.ok{display:block;color:#0baa6e}.hint.e2{display:block;color:#e03050}
.sbar{height:3px;border-radius:2px;background:#18182a;margin-top:5px;overflow:hidden}
.sfill{height:100%;border-radius:2px;transition:width .3s,background .3s;width:0}
.aerr{display:none;padding:11px 13px;border-radius:10px;font-size:12px;margin-bottom:12px;line-height:1.4;background:rgba(224,48,80,.1);border:1px solid rgba(224,48,80,.22);color:#ff8099}
.aerr.show{display:block}
.abtn{width:100%;padding:15px;margin-top:6px;background:linear-gradient(135deg,var(--acc),var(--acc2));border:none;border-radius:11px;color:#fff;font-family:'Unbounded',sans-serif;font-size:12px;font-weight:700;cursor:pointer;letter-spacing:.05em;box-shadow:0 4px 22px var(--glow);transition:transform .15s}
.abtn:active{transform:scale(.97)}
.alegal{text-align:center;margin-top:16px;font-size:11px;color:#3a3a60;line-height:1.5}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APP SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#app-screen{background:#07070f}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:12px 16px 10px;background:#0c0c1a;border-bottom:1px solid rgba(255,255,255,.07);flex-shrink:0}
.topbar-t{font-family:'Unbounded',sans-serif;font-size:15px;font-weight:700;color:#eeeeff}
.topav{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,var(--acc),var(--acc2));display:flex;align-items:center;justify-content:center;font-family:'Unbounded',sans-serif;font-size:13px;font-weight:700;color:#fff;cursor:pointer;box-shadow:0 2px 8px var(--glow)}
.page{display:none;flex:1;overflow-y:auto;padding-bottom:calc(var(--tab) + 24px);-webkit-overflow-scrolling:touch;background:#07070f;height:calc(100vh - 44px - var(--tab))}
.page.active{display:block}
/* Ambassadors page needs extra bottom padding for logout button */
#page-ambassadors{padding-bottom:calc(var(--tab) + 48px)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HERO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero{margin:12px;border-radius:18px;overflow:hidden;position:relative;height:165px;background:linear-gradient(135deg,#0a1855 0%,#1e3a8a 50%,#070720 100%)}
.hs1{position:absolute;top:-30px;right:-30px;width:200px;height:200px;border-radius:50%;background:radial-gradient(circle,rgba(61,90,241,.5)0%,transparent 65%);animation:pulse 4s ease-in-out infinite}
.hs2{position:absolute;bottom:-40px;left:20px;width:150px;height:150px;border-radius:50%;background:radial-gradient(circle,rgba(108,61,232,.3)0%,transparent 65%);animation:pulse 4s ease-in-out infinite .8s}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
.hero-cnt{position:relative;z-index:2;padding:18px;height:100%;display:flex;flex-direction:column;justify-content:space-between}
.hero-title{font-family:'Unbounded',sans-serif;font-size:20px;font-weight:900;color:#fff;line-height:1.2}
.hero-sub{font-size:12px;color:rgba(255,255,255,.5);margin-top:3px}
.hero-pills{display:flex;gap:7px;flex-wrap:wrap}
.hero-pill{background:rgba(255,255,255,.13);border-radius:7px;padding:5px 10px;font-size:10px;font-weight:600;color:#fff}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEARCH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hswrap{margin:0 12px 12px;position:relative}
.hsip{
  width:100%;padding:12px 14px 12px 42px;
  background:#18182a!important;background-color:#18182a!important;
  box-shadow:inset 0 0 0 1000px #18182a!important;
  border:1.5px solid rgba(255,255,255,0.12)!important;border-radius:12px;
  color:#eeeeff!important;-webkit-text-fill-color:#eeeeff!important;
  font-family:'Manrope',sans-serif;font-size:14px;
  outline:none;-webkit-appearance:none!important;caret-color:#3d5af1;
}
.hsip:focus{border-color:#3d5af1!important}
.hsip::placeholder{color:#3a3a60!important;-webkit-text-fill-color:#3a3a60!important}
.hsip:-webkit-autofill{-webkit-box-shadow:0 0 0 1000px #18182a inset!important;-webkit-text-fill-color:#eeeeff!important}
.hsico{position:absolute;left:13px;top:50%;transform:translateY(-50%);opacity:.4;display:flex;pointer-events:none;color:#eeeeff}
.chips{display:flex;gap:7px;padding:0 12px;overflow-x:auto;scrollbar-width:none;margin-bottom:14px}
.chips::-webkit-scrollbar{display:none}
.chip{padding:6px 14px;border-radius:20px;background:#18182a;border:1px solid rgba(255,255,255,.11);color:#7777aa;font-size:12px;font-weight:600;cursor:pointer;white-space:nowrap;flex-shrink:0;transition:all .15s}
.chip.on{background:var(--acc);border-color:var(--acc);color:#fff}
.sec{font-family:'Unbounded',sans-serif;font-size:10px;font-weight:700;letter-spacing:.1em;color:#7777aa;text-transform:uppercase;padding:0 12px;margin:18px 0 10px}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CATEGORY CARDS â€” matching screenshot style
   White text, dark overlay, icon top-right
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.catgrid{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:0 12px}
.ccard{border-radius:16px;overflow:hidden;position:relative;cursor:pointer;height:115px;transition:transform .18s}
.ccard:active{transform:scale(.95)}
.ccard-ov{position:absolute;inset:0;background:linear-gradient(160deg,rgba(0,0,0,.15)0%,rgba(0,0,0,.65)100%)}
.ccard-ico{position:absolute;top:12px;right:12px;opacity:.35;width:36px;height:36px}
.ccard-body{position:absolute;bottom:0;left:0;right:0;padding:10px 13px 12px;z-index:2}
.ccard-cnt{font-size:10px;color:rgba(255,255,255,.55);margin-bottom:3px;font-weight:500}
.ccard-name{font-family:'Unbounded',sans-serif;font-size:11px;font-weight:800;letter-spacing:.05em;text-transform:uppercase;color:#fff;line-height:1.2}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   POST CARDS â€” white card style matching screenshot
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.pcard{background:#fff;border-radius:16px;border:none;margin-bottom:10px;cursor:pointer;overflow:hidden;transition:transform .15s;box-shadow:0 2px 16px rgba(0,0,0,.25)}
.pcard:active{transform:scale(.98)}
.pcard-img{width:100%;height:140px;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}
.pcard-img-ov{position:absolute;bottom:0;left:0;right:0;height:60px;background:linear-gradient(to top,rgba(0,0,0,.4),transparent)}
.pcard-body{padding:13px 14px 14px;background:#fff}
.pcard-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px}
.pcard-title{font-size:14px;font-weight:700;line-height:1.35;flex:1;margin-right:8px;color:#0a0a1a}
.favbtn{background:none;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;width:28px;height:28px;flex-shrink:0;transition:transform .2s}
.favbtn:active{transform:scale(1.3)}.favbtn.on{color:#fbbf24}
.pcard-prev{font-size:12px;color:#555;line-height:1.5;margin-bottom:10px;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}
.pcard-foot{display:flex;gap:6px;flex-wrap:wrap;align-items:center}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RECENT LIST posts (dark card)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.rlist{padding:0 12px}
.rpost{display:flex;gap:10px;align-items:flex-start;padding:12px;border-radius:13px;background:#111122;border:1px solid rgba(255,255,255,.07);margin-bottom:8px;cursor:pointer;transition:opacity .15s}
.rpost:active{opacity:.75}
.rthumb{width:60px;height:60px;border-radius:10px;flex-shrink:0;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}
.rthumb-ico{position:absolute;inset:0;display:flex;align-items:center;justify-content:center}
.ri{flex:1;min-width:0}
.rt2{font-size:13px;font-weight:600;line-height:1.35;margin-bottom:5px;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;color:#eeeeff}
.rm{display:flex;align-items:center;gap:6px;flex-wrap:wrap}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   REFERRAL BANNER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.refb{margin:0 12px 4px;background:#18182a;border:1px solid rgba(255,255,255,.11);border-radius:14px;padding:13px;display:flex;align-items:center;gap:11px}
.rbico{width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,var(--acc),var(--acc2));display:flex;align-items:center;justify-content:center;flex-shrink:0}
.rbt{flex:1;min-width:0}
.rbth{font-size:13px;font-weight:700;margin-bottom:2px;color:#eeeeff}
.rbtl{font-size:11px;color:#7777aa;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
/* â•â•â•â• ADMIN PANEL â•â•â•â• */
.adm-tab{flex:1;padding:10px 0;background:none;border:none;border-bottom:2px solid transparent;color:#7777aa;font-size:12px;font-weight:600;cursor:pointer;font-family:Manrope;transition:all .2s}
.adm-tab.on{color:#eeeeff;border-bottom-color:var(--acc)}
.adm-field{margin-bottom:12px}
.adm-field label{display:block;font-size:11px;font-weight:600;color:#7777aa;margin-bottom:5px;text-transform:uppercase;letter-spacing:.04em}
.adm-field input,.adm-field textarea,.adm-field select{width:100%;background:#18182a;border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:10px 12px;color:#eeeeff;font-size:13px;font-family:Manrope;outline:none;box-sizing:border-box;resize:vertical}
.adm-field select{appearance:none;cursor:pointer}
.adm-field input:focus,.adm-field textarea:focus,.adm-field select:focus{border-color:var(--acc)}
.adm-btn{width:100%;padding:13px;background:linear-gradient(135deg,#3d5af1,#6366f1);border:none;border-radius:12px;color:#fff;font-size:14px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;font-family:Manrope;margin-top:4px;transition:opacity .2s}
.adm-btn:active{opacity:.8}
.adm-btn.danger{background:linear-gradient(135deg,#e03050,#c02040)}
.adm-post-item{background:#111122;border-radius:12px;padding:12px 14px;margin-bottom:8px;border:1px solid rgba(255,255,255,.07);display:flex;align-items:center;gap:10px}
.adm-post-del{width:30px;height:30px;border-radius:8px;background:rgba(224,48,80,.1);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#e03050;flex-shrink:0}
.adm-user-item{background:#111122;border-radius:12px;padding:12px 14px;margin-bottom:8px;border:1px solid rgba(255,255,255,.07)}
.adm-user-row{display:flex;align-items:center;gap:10px}
.adm-user-av{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;color:#fff;flex-shrink:0}
.adm-user-info{flex:1;min-width:0}
.adm-user-name{font-size:13px;font-weight:700;color:#eeeeff}
.adm-user-meta{font-size:11px;color:#7777aa;margin-top:2px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.adm-user-stats{display:flex;gap:10px;margin-top:8px;padding-top:8px;border-top:1px solid rgba(255,255,255,.05)}
.adm-stat{font-size:11px;color:#7777aa}
.adm-stat b{color:#eeeeff}
.adm-block-btn{padding:5px 10px;border-radius:7px;border:none;font-size:11px;font-weight:700;cursor:pointer;font-family:Manrope}
.adm-block-btn.block{background:rgba(224,48,80,.15);color:#ff8099}
.adm-block-btn.unblock{background:rgba(11,170,110,.15);color:#34d399}
.blocked-badge{background:rgba(224,48,80,.2);color:#ff6080;font-size:10px;padding:2px 7px;border-radius:5px;font-weight:700;margin-left:6px}
@keyframes cpShake{0%,100%{transform:translateX(0)}25%{transform:translateX(-3px)}75%{transform:translateX(3px)}}
.cp-success{background:rgba(11,170,110,.15)!important;border-color:rgba(11,170,110,.4)!important;color:#34d399!important}
.cp-bounce{animation:cpPop .35s ease}
.rbcp{background:#111122;border:1px solid rgba(255,255,255,.11);border-radius:8px;padding:7px 10px;display:flex;align-items:center;gap:4px;font-size:11px;font-weight:600;color:#7777aa;cursor:pointer;flex-shrink:0;white-space:nowrap;transition:all .25s}
.rbcp:active{transform:scale(.96)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   COMMUNITY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.clist{padding:12px}
.ci{display:flex;align-items:center;gap:12px;padding:14px;background:#111122;border-radius:13px;border:1px solid rgba(255,255,255,.07);margin-bottom:8px;cursor:pointer;transition:opacity .15s}
.ci:active{opacity:.75}
.ciico{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.cib{flex:1}.cit{font-size:14px;font-weight:600;margin-bottom:2px;color:#eeeeff}.cis{font-size:12px;color:#7777aa}
.ciarr{color:#3a3a60}
.csec{font-family:'Unbounded',sans-serif;font-size:10px;font-weight:700;letter-spacing:.08em;color:#7777aa;text-transform:uppercase;padding:0 12px;margin:16px 0 8px}
.repbox{margin:12px;border-radius:13px;background:rgba(224,48,80,.07);border:1px solid rgba(224,48,80,.18);padding:14px}
.rept{font-size:13px;font-weight:700;color:#ff8099;margin-bottom:4px;display:flex;align-items:center;gap:6px}
.reps{font-size:12px;color:#7777aa;line-height:1.5}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROJECTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.pjitem{display:flex;align-items:center;gap:12px;padding:14px;background:#111122;border-radius:13px;border:1px solid rgba(255,255,255,.07);margin-bottom:8px;cursor:pointer;transition:opacity .15s}
.pjitem:active{opacity:.75}
.pjav{width:46px;height:46px;border-radius:14px;flex-shrink:0;display:flex;align-items:center;justify-content:center}
.pjb{flex:1}.pjt{font-size:14px;font-weight:600;margin-bottom:3px;color:#eeeeff}.pjs{font-size:12px;color:#7777aa}
.pjbdg{background:var(--acc);border-radius:20px;padding:2px 8px;font-size:10px;font-weight:700;color:#fff}
.addpj{margin:0 12px;padding:14px;background:#18182a;border:1.5px dashed rgba(255,255,255,.11);border-radius:13px;display:flex;align-items:center;justify-content:center;gap:8px;font-size:13px;font-weight:600;color:#7777aa;cursor:pointer;transition:all .15s}
.addpj:active{border-color:var(--acc);color:var(--acc)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AMBASSADORS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.amhdr{margin:12px;border-radius:18px;overflow:hidden;position:relative;height:140px;background:linear-gradient(135deg,#0a1855,#1e3a8a,#0f1f60)}
.amhdr-gl{position:absolute;top:-20px;right:-20px;width:160px;height:160px;border-radius:50%;background:radial-gradient(circle,rgba(61,90,241,.5)0%,transparent 65%)}
.amhdr-cnt{position:relative;z-index:2;padding:18px;height:100%;display:flex;flex-direction:column;justify-content:flex-end}
.amhdr-t{font-family:'Unbounded',sans-serif;font-size:18px;font-weight:900;color:#fff}
.amhdr-s{font-size:12px;color:rgba(255,255,255,.55);margin-top:3px}
.amprof{margin:0 12px 10px;background:#111122;border-radius:14px;border:1px solid rgba(255,255,255,.07);padding:15px}
.ampt{display:flex;align-items:center;gap:12px;margin-bottom:13px}
.amav{width:52px;height:52px;border-radius:14px;background:linear-gradient(135deg,var(--acc),var(--acc2));display:flex;align-items:center;justify-content:center;font-family:'Unbounded',sans-serif;font-size:20px;font-weight:700;color:#fff}
.amname{font-family:'Unbounded',sans-serif;font-size:15px;font-weight:700;color:#eeeeff}
.amlvl{font-size:12px;color:#7777aa;margin-top:2px}
.amstats{display:flex;gap:8px}
.asb{flex:1;background:#07070f;border-radius:10px;padding:11px 8px;text-align:center;border:1px solid rgba(255,255,255,.05)}
.asn{font-family:'Unbounded',sans-serif;font-size:18px;font-weight:800;color:var(--acc)}.asl{font-size:10px;color:#7777aa;margin-top:2px}

.lvlrow{display:flex;gap:8px;padding:0 12px;overflow-x:auto;scrollbar-width:none;margin-bottom:4px}
.lvlrow::-webkit-scrollbar{display:none}
.lvlcard{flex-shrink:0;width:108px;border-radius:12px;padding:12px 10px;border:1.5px solid rgba(255,255,255,.07);background:#18182a;text-align:center;transition:all .2s}
.lvlcard.active{border-color:var(--acc);background:rgba(61,90,241,.12)}
.lvl-e{font-size:22px;margin-bottom:4px}
.lvl-n{font-family:'Unbounded',sans-serif;font-size:9px;font-weight:700;text-transform:uppercase;color:#eeeeff;margin-bottom:2px}
.lvl-r{font-size:10px;color:#7777aa}

.pgbox{margin:0 12px 10px;background:#111122;border-radius:13px;border:1px solid rgba(255,255,255,.07);padding:14px}
.pgt{font-size:13px;font-weight:700;margin-bottom:8px;color:#eeeeff}
.pgbar{height:6px;background:#18182a;border-radius:4px;overflow:hidden}
.pgfill{height:100%;border-radius:4px;background:linear-gradient(90deg,var(--acc),var(--acc2));width:0;transition:width 1.2s ease}
.pgs{font-size:11px;color:#7777aa;margin-top:6px}

.amref{margin:0 12px 10px;background:#111122;border-radius:13px;border:1px solid rgba(255,255,255,.07);padding:14px}
.amrh{font-size:12px;font-weight:700;margin-bottom:8px;display:flex;align-items:center;gap:6px;color:#eeeeff}
.amrl{background:#07070f;border-radius:9px;padding:10px 12px;font-size:12px;color:#7777aa;display:flex;align-items:center;justify-content:space-between;cursor:pointer;gap:8px;border:1px solid rgba(255,255,255,.05)}
.amrl span:first-child{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.amrl:active{background:#111122}

/* â•â• LEADERBOARD â•â• */
.lb{margin:0 12px}
.lbi{display:flex;align-items:center;gap:10px;padding:12px;background:#111122;border-radius:12px;border:1px solid rgba(255,255,255,.07);margin-bottom:7px;transition:border-color .2s}
.lbi.me{border-color:var(--acc);background:rgba(61,90,241,.08)}
.lbr{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-family:'Unbounded',sans-serif;font-size:11px;font-weight:700;flex-shrink:0}
.r1{background:linear-gradient(135deg,#d4a011,#f0c840);color:#000}
.r2{background:linear-gradient(135deg,#808080,#b8b8b8);color:#000}
.r3{background:linear-gradient(135deg,#9d5a2a,#c07840);color:#fff}
.rn{background:#18182a;color:#7777aa}
.lbav{width:36px;height:36px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-family:'Unbounded',sans-serif;font-size:13px;font-weight:700;color:#fff}
.lbn{flex:1;font-size:13px;font-weight:600;color:#eeeeff}
.lbn.me{color:var(--acc)}
.lbs{font-family:'Unbounded',sans-serif;font-size:13px;font-weight:700;color:var(--acc)}
.lb-loading{text-align:center;padding:20px;font-size:13px;color:#7777aa}

.shoprow{display:flex;gap:8px;overflow-x:auto;scrollbar-width:none;padding:0 12px 4px}
.shoprow::-webkit-scrollbar{display:none}
.shopc{flex-shrink:0;width:140px;border-radius:13px;overflow:hidden;background:#111122;border:1px solid rgba(255,255,255,.07);cursor:pointer}
.shopi{height:85px;display:flex;align-items:center;justify-content:center}
.shopb{padding:9px 10px}.shopn{font-size:11px;font-weight:700;margin-bottom:2px;color:#eeeeff}.shopp{font-size:10px;color:#7777aa}
.amout{margin:10px 12px 24px;padding:14px;background:rgba(224,48,80,.09);border:1px solid rgba(224,48,80,.2);border-radius:13px;color:#ff8099;font-size:13px;font-weight:600;cursor:pointer;text-align:center}
.amout:active{background:rgba(224,48,80,.18)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   POST DETAIL â€” matching screenshot exactly
   Dark bg, white action buttons at bottom
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#det{display:none;position:fixed;inset:0;background:#0e0e18;z-index:100;overflow-y:auto;-webkit-overflow-scrolling:touch}
#det.show{display:block}
.dhead{padding:11px 14px;display:flex;align-items:center;gap:10px;border-bottom:1px solid rgba(255,255,255,.07);position:sticky;top:0;background:#0e0e18;z-index:10}
.dback{width:36px;height:36px;border-radius:10px;background:#1c1c2e;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#aaaacc;flex-shrink:0}
.dback:active{background:#252538}
.dht{font-size:14px;font-weight:600;flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:#ccccdd}
.dhero{width:100%;height:200px;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}
.dhero-ov{position:absolute;bottom:0;left:0;right:0;height:80px;background:linear-gradient(to top,#0e0e18,transparent);z-index:2}
.dcnt{padding:18px 18px 28px;background:#0e0e18}
.dbadges{display:flex;gap:6px;margin-bottom:12px;flex-wrap:wrap;align-items:center}
.dtitle{font-family:'Unbounded',sans-serif;font-size:18px;font-weight:800;line-height:1.3;margin-bottom:14px;color:#ccccdd}
.dbody{font-size:14px;line-height:1.78;color:#8888aa;white-space:pre-line;margin-bottom:20px}
.dtags{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:24px}

/* â˜… Action buttons â€” WHITE cards matching screenshot */
.dactions{display:flex;gap:10px}
.dbtn{
  flex:1;display:flex;align-items:center;justify-content:center;gap:8px;
  padding:16px;border-radius:14px;border:none;cursor:pointer;
  font-family:'Manrope',sans-serif;font-size:14px;font-weight:700;
  transition:transform .15s,opacity .15s;text-decoration:none;
}
.dbtn:active{transform:scale(.97);opacity:.9}
/* White card buttons like in screenshot */
.btn-watch{background:#fff;color:#0a0a1a;box-shadow:0 2px 12px rgba(0,0,0,.3)}
.btn-consp{background:#fff;color:#0a0a1a;box-shadow:0 2px 12px rgba(0,0,0,.3)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BADGES & TAGS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.badge{padding:3px 9px;border-radius:6px;font-size:10px;font-weight:700;letter-spacing:.06em;text-transform:uppercase;white-space:nowrap}
.b-post{background:rgba(61,90,241,.18);color:#818cf8}
.b-video{background:rgba(108,61,232,.18);color:#a78bfa}
.b-invest{background:rgba(232,100,10,.18);color:#fb923c}
.b-case{background:rgba(212,160,17,.18);color:#fbbf24}
.b-news{background:rgba(11,170,110,.18);color:#34d399}
.tag{font-size:10px;color:#7777aa;background:rgba(255,255,255,.06);padding:3px 8px;border-radius:5px}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOTTOM NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.bnav{position:fixed;bottom:0;left:0;right:0;background:#0c0c1a;border-top:1px solid rgba(255,255,255,.07);display:flex;align-items:stretch;z-index:50;padding-bottom:env(safe-area-inset-bottom,0px)}
.ntab{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:3px;padding:9px 4px;cursor:pointer;color:#3a3a60;transition:color .15s;border:none;background:none;min-height:var(--tab)}
.ntab.on{color:var(--acc)}
.ntab svg{width:22px;height:22px;flex-shrink:0}
.ntabl{font-size:9px;font-weight:600;letter-spacing:.03em;line-height:1;color:inherit}
.toast{position:fixed;bottom:calc(var(--tab)+14px);left:50%;transform:translateX(-50%) translateY(14px);background:#18182a;border:1px solid rgba(255,255,255,.11);border-radius:12px;padding:10px 18px;font-size:12px;font-weight:600;color:#eeeeff;opacity:0;transition:all .3s;z-index:200;white-space:nowrap;pointer-events:none}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.empty{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 24px;text-align:center;gap:8px}
.empt{font-family:'Unbounded',sans-serif;font-size:14px;color:#eeeeff}.emps{font-size:12px;color:#7777aa}
.pcards{padding:0 12px}
</style>
</head>
<body>

<!-- SVG DEFS -->
<svg width="0" height="0" style="position:absolute;overflow:hidden">
<defs>
<symbol id="i-coin" viewBox="0 0 60 60"><circle cx="30" cy="30" r="26" fill="currentColor" opacity=".25"/><circle cx="30" cy="30" r="20" fill="currentColor" opacity=".4"/><text x="30" y="37" text-anchor="middle" font-size="18" font-weight="900" fill="white" opacity=".9">â‚½</text></symbol>
<symbol id="i-build" viewBox="0 0 60 60"><rect x="6" y="22" width="15" height="32" fill="currentColor" opacity=".8"/><rect x="24" y="12" width="18" height="42" fill="currentColor"/><rect x="45" y="28" width="12" height="26" fill="currentColor" opacity=".7"/><rect x="9" y="26" width="3" height="3" fill="white" opacity=".5"/><rect x="15" y="26" width="3" height="3" fill="white" opacity=".5"/><rect x="9" y="33" width="3" height="3" fill="white" opacity=".4"/><rect x="15" y="33" width="3" height="3" fill="white" opacity=".4"/><rect x="27" y="16" width="4" height="4" fill="white" opacity=".5"/><rect x="35" y="16" width="4" height="4" fill="white" opacity=".5"/><rect x="27" y="24" width="4" height="4" fill="white" opacity=".6"/><rect x="35" y="24" width="4" height="4" fill="white" opacity=".4"/><rect x="27" y="32" width="4" height="4" fill="white" opacity=".4"/><rect x="35" y="32" width="4" height="4" fill="white" opacity=".6"/></symbol>
<symbol id="i-chart" viewBox="0 0 60 60"><rect x="5" y="42" width="10" height="14" rx="2" fill="currentColor" opacity=".6"/><rect x="19" y="30" width="10" height="26" rx="2" fill="currentColor" opacity=".75"/><rect x="33" y="18" width="10" height="38" rx="2" fill="currentColor" opacity=".9"/><rect x="47" y="8" width="10" height="48" rx="2" fill="currentColor"/><polyline points="10,42 24,30 38,18 52,8" fill="none" stroke="white" stroke-width="1.5" opacity=".4"/><circle cx="10" cy="42" r="2" fill="white" opacity=".5"/><circle cx="24" cy="30" r="2" fill="white" opacity=".5"/><circle cx="38" cy="18" r="2" fill="white" opacity=".5"/><circle cx="52" cy="8" r="2" fill="white" opacity=".5"/></symbol>
<symbol id="i-play" viewBox="0 0 60 60"><circle cx="30" cy="30" r="24" fill="currentColor" opacity=".2"/><circle cx="30" cy="30" r="18" fill="currentColor" opacity=".4"/><polygon points="25,22 45,30 25,38" fill="white" opacity=".85"/></symbol>
<symbol id="i-news" viewBox="0 0 60 60"><rect x="8" y="10" width="36" height="42" rx="3" fill="currentColor" opacity=".7"/><rect x="44" y="14" width="12" height="32" rx="2" fill="currentColor" opacity=".45"/><rect x="13" y="17" width="22" height="5" rx="2" fill="white" opacity=".5"/><rect x="13" y="26" width="17" height="3" rx="1.5" fill="white" opacity=".35"/><rect x="13" y="33" width="20" height="3" rx="1.5" fill="white" opacity=".3"/><rect x="13" y="40" width="15" height="3" rx="1.5" fill="white" opacity=".25"/></symbol>
<symbol id="i-edu" viewBox="0 0 60 60"><rect x="10" y="10" width="28" height="42" rx="2" fill="currentColor" opacity=".8"/><rect x="38" y="10" width="14" height="42" rx="2" fill="currentColor" opacity=".5"/><rect x="15" y="17" width="18" height="3.5" rx="1.5" fill="white" opacity=".5"/><rect x="15" y="25" width="14" height="3" rx="1.5" fill="white" opacity=".4"/><rect x="15" y="32" width="16" height="3" rx="1.5" fill="white" opacity=".35"/></symbol>
</defs>
</svg>

<!-- â•â•â•â•â•â•â•â• AUTH â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="auth-screen" class="screen active">
  <div class="orb o1"></div><div class="orb o2"></div>
  <div class="ascroll">
    <div class="alogo">
      <div class="aring">
        <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.8" stroke-linecap="round"><line x1="12" y1="2" x2="12" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
      </div>
      <div class="aname">INVESTAT</div>
      <div class="asub">ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸</div>
    </div>
    <div class="seg">
      <button class="segb on" id="bl" onclick="sw('l')">Ğ’Ğ¾Ğ¹Ñ‚Ğ¸</button>
      <button class="segb" id="br" onclick="sw('r')">Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ</button>
    </div>
    <!-- LOGIN -->
    <div id="fl">
      <div class="aerr" id="la"></div>
      <div class="fg">
        <div class="fl"><svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>Email</div>
        <div class="fw"><span class="fico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-10 7L2 7"/></svg></span><input class="fi" type="email" id="le" placeholder="example@mail.ru" autocomplete="email"></div>
      </div>
      <div class="fg">
        <div class="fl"><svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2z"/></svg>ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ</div>
        <div class="fw"><span class="fico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg></span><input class="fi" type="password" id="lp" placeholder="Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ" autocomplete="current-password"><button class="feye" type="button" onclick="tp('lp',this)"><svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button></div>
      </div>
      <button class="abtn" onclick="doLogin()">Ğ’ĞĞ™Ğ¢Ğ˜ Ğ’ ĞĞšĞšĞĞ£ĞĞ¢</button>
    </div>
    <!-- REGISTER -->
    <div id="fr" style="display:none">
      <div class="aerr" id="ra"></div>
      <div class="fg"><div class="fl">Ğ˜Ğ¼Ñ</div><div class="fw"><span class="fico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></span><input class="fi" type="text" id="rn" placeholder="Ğ’Ğ°ÑˆĞµ Ğ¸Ğ¼Ñ" oninput="vN()" autocomplete="given-name"></div><div class="hint" id="hn"></div></div>
      <div class="fg"><div class="fl">Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½ <span style="color:var(--red)">*</span></div><div class="fw"><span class="fico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 12 19.79 19.79 0 0 1 1.61 3.38 2 2 0 0 1 3.58 1h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L7.91 8.96a16 16 0 0 0 6.29 6.29l1.32-1.32a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg></span><input class="fi" type="tel" id="rph" placeholder="+7 (999) 000-00-00" oninput="vPh()" autocomplete="tel"></div><div class="hint" id="hph"></div></div>
      <div class="fg"><div class="fl">Email <span style="color:var(--red)">*</span></div><div class="fw"><span class="fico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-10 7L2 7"/></svg></span><input class="fi" type="email" id="rem" placeholder="example@mail.ru" oninput="vE()" autocomplete="email"></div><div class="hint" id="hem"></div></div>
      <div class="fg"><div class="fl">ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ <span style="color:var(--red)">*</span></div><div class="fw"><span class="fico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg></span><input class="fi" type="password" id="rp" placeholder="ĞœĞ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 8 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²" oninput="vP()" autocomplete="new-password"><button class="feye" type="button" onclick="tp('rp',this)"><svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button></div><div class="sbar"><div class="sfill" id="sf"></div></div><div class="hint" id="hp"></div></div>
      <div class="fg"><div class="fl">ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ <span style="color:var(--red)">*</span></div><div class="fw"><span class="fico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4"/><circle cx="12" cy="12" r="10"/></svg></span><input class="fi" type="password" id="rp2" placeholder="ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ" oninput="vP2()" autocomplete="new-password"></div><div class="hint" id="hp2"></div></div>
      <button class="abtn" onclick="doReg()">Ğ¡ĞĞ—Ğ”ĞĞ¢Ğ¬ ĞĞšĞšĞĞ£ĞĞ¢</button>
    </div>
    <div class="alegal">ĞĞ°Ğ¶Ğ¸Ğ¼Ğ°Ñ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ, Ğ²Ñ‹ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ<br>Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ³Ğ¾ ÑĞ¾Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ñ</div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â• APP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="app-screen" class="screen">
  <div class="topbar">
    <div class="topbar-t" id="ptitle">Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ</div>
    <div class="topav" id="topav" onclick="gt('ambassadors',document.querySelectorAll('.ntab')[4])">A</div>
  </div>

  <!-- HOME -->
  <div id="page-home" class="page active">
    <div class="hero">
      <div class="hs1"></div><div class="hs2"></div>
      <div class="hero-cnt">
        <div><div class="hero-title">INVESTAT</div><div class="hero-sub">ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸</div></div>
        <div class="hero-pills">
          <div class="hero-pill">Ğ”Ğ¾ 67% Ğ³Ğ¾Ğ´Ğ¾Ğ²Ñ‹Ñ…</div>
          <div class="hero-pill">Ğ Ğ°Ğ·Ğ±Ğ¾Ñ€Ñ‹</div>
          <div class="hero-pill">ĞšĞµĞ¹ÑÑ‹</div>
          <div class="hero-pill">ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸</div>
        </div>
      </div>
    </div>
    <div class="hswrap">
      <span class="hsico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></span>
      <input class="hsip" type="search" id="hsi" placeholder="ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ğ¾ÑÑ‚Ñ‹, Ñ€Ğ°Ğ·Ğ±Ğ¾Ñ€Ñ‹, Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹..." oninput="onHS()"
        style="background:#18182a!important;background-color:#18182a!important;box-shadow:inset 0 0 0 1000px #18182a!important;color:#eeeeff!important;-webkit-text-fill-color:#eeeeff!important">
    </div>
    <div class="chips" id="hchips">
      <div class="chip on" onclick="setHC(this,'all')">Ğ’ÑĞµ</div>
      <div class="chip" onclick="setHC(this,'invest')">Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸</div>
      <div class="chip" onclick="setHC(this,'case')">ĞšĞµĞ¹ÑÑ‹</div>
      <div class="chip" onclick="setHC(this,'video')">Ğ’Ğ¸Ğ´ĞµĞ¾</div>
      <div class="chip" onclick="setHC(this,'news')">ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸</div>
      <div class="chip" onclick="setHC(this,'post')">ĞŸĞ¾ÑÑ‚Ñ‹</div>
    </div>
    <div id="hsr" style="display:none" class="pcards"></div>
    <div id="hdef">
      <div class="sec">Ğ Ğ°Ğ·Ğ´ĞµĞ»Ñ‹</div>
      <div class="catgrid" id="catg"></div>
      <div class="sec" style="margin-top:20px">Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°</div>
      <div class="refb">
        <div class="rbico"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg></div>
        <div class="rbt"><div class="rbth">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸ Ğ´Ñ€ÑƒĞ³Ğ°</div><div class="rbtl" id="hrl">t.me/navigationinvestat_bot?start=ref_...</div></div>
        <div class="rbcp" id="hcpbtn" onclick="cpHR()">
          <svg id="hcpico" width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
          <span id="hcptxt">ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ</span>
        </div>
      </div>
      <div class="sec">ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ Ğ¿Ğ¾ÑÑ‚Ñ‹</div>
      <div class="rlist" id="recl"></div>
    </div>
  </div>

  <!-- COMMUNITY -->
  <div id="page-community" class="page">
    <div class="clist">
      <div class="ci" onclick="ol('https://t.me/+c4ekMHlWBbQzYjUy')"><div class="ciico" style="background:linear-gradient(135deg,#0a1855,#1e3a8a)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg></div><div class="cib"><div class="cit">INVESTAT</div><div class="cis">ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ°Ğ½Ğ°Ğ»</div></div><svg class="ciarr" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg></div>
      <div class="ci" onclick="showT('Ğ¡ĞºĞ¾Ñ€Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾')"><div class="ciico" style="background:linear-gradient(135deg,#0f2040,#1a3060)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg></div><div class="cib"><div class="cit">Ğ§Ğ°Ñ‚ Ğ¸Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€Ğ¾Ğ²</div><div class="cis">ĞĞ±ÑÑƒĞ¶Ğ´ĞµĞ½Ğ¸Ñ Ğ¸ Ğ½ĞµÑ‚Ğ²Ğ¾Ñ€ĞºĞ¸Ğ½Ğ³</div></div><svg class="ciarr" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg></div>
    </div>
    <div class="csec">ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ¸ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°</div>
    <div class="clist" style="padding-top:0">
      <div class="ci" onclick="showT('ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµĞ¼...')"><div class="ciico" style="background:linear-gradient(135deg,#1a1a5a,#0f0f3a)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#818cf8" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg></div><div class="cib"><div class="cit">ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ°</div><div class="cis">Ğ˜Ğ·ÑƒÑ‡Ğ¸ Ğ¿ĞµÑ€ĞµĞ´ ÑƒÑ‡Ğ°ÑÑ‚Ğ¸ĞµĞ¼</div></div><svg class="ciarr" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg></div>
      <div class="ci" onclick="showT('ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµĞ¼...')"><div class="ciico" style="background:linear-gradient(135deg,#3a1800,#200e00)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fb923c" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg></div><div class="cib"><div class="cit">Ğ¡Ğ»ÑƒĞ¶Ğ±Ğ° Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¸</div><div class="cis">ĞŸĞ½â€“ĞŸÑ‚ 10:00 â€“ 19:00</div></div><svg class="ciarr" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg></div>
    </div>
    <div class="repbox"><div class="rept"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>Ğ¡Ğ¾Ğ¾Ğ±Ñ‰Ğ¸Ñ‚ÑŒ Ğ¾ Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ğ¸</div><div class="reps">Ğ•ÑĞ»Ğ¸ Ğ¿Ğ¸ÑˆÑƒÑ‚ Ğ² Ğ»Ğ¸Ñ‡ĞºÑƒ ÑĞ¾ ÑĞ¿Ğ°Ğ¼Ğ¾Ğ¼ Ğ¸Ğ»Ğ¸ Ğ·Ğ°Ğ¼ĞµÑ‚Ğ¸Ğ» Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ğµ â€” ÑĞ¾Ğ¾Ğ±Ñ‰Ğ¸ Ğ½Ğ°Ğ¼!</div></div>
  </div>

  <!-- PROJECTS -->
  <div id="page-projects" class="page">
    <div style="padding:12px">
      <div class="pjitem" onclick="ol('https://t.me/+c4ekMHlWBbQzYjUy')"><div class="pjav" style="background:linear-gradient(135deg,#0a1855,#1e3a8a)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg></div><div class="pjb"><div class="pjt">ĞšĞ°Ğ½Ğ°Ğ» INVESTAT</div><div class="pjs">ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸</div></div><span class="pjbdg">NEW</span></div>
      <div class="pjitem" onclick="showT('Ğ¡ĞºĞ¾Ñ€Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾')"><div class="pjav" style="background:linear-gradient(135deg,#062a18,#0a3a22)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></div><div class="pjb"><div class="pjt">ĞŸĞ¾Ñ€Ñ‚Ğ°Ğ» Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ²</div><div class="pjs">Ğ ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ²</div></div></div>
      <div class="pjitem" onclick="showT('Ğ¡ĞºĞ¾Ñ€Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾')"><div class="pjav" style="background:linear-gradient(135deg,#2a1200,#3a1a00)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg></div><div class="pjb"><div class="pjt">ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ñ€Ñ‹Ğ½ĞºĞ°</div><div class="pjs">Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ñ‹Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ</div></div></div>
      <div class="pjitem" onclick="showT('Ğ¡ĞºĞ¾Ñ€Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾')"><div class="pjav" style="background:linear-gradient(135deg,#20082a,#2a1040)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></div><div class="pjb"><div class="pjt">Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ñ‹Ğ¹ ĞºĞ»ÑƒĞ±</div><div class="pjs">ĞĞµÑ‚Ğ²Ğ¾Ñ€ĞºĞ¸Ğ½Ğ³ Ğ¸Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€Ğ¾Ğ²</div></div></div>
      <div class="addpj" onclick="showT('Ğ¡ĞºĞ¾Ñ€Ğ¾')"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚</div>
    </div>
  </div>

  <!-- COLLECTIONS -->
  <div id="page-collections" class="page">
    <div class="pcards" id="colllist" style="padding-top:12px"></div>
  </div>

  <!-- AMBASSADORS -->
  <div id="page-ambassadors" class="page">
    <div class="amhdr"><div class="amhdr-gl"></div><div class="amhdr-cnt"><div class="amhdr-t">ĞĞ¼Ğ±Ğ°ÑÑĞ°Ğ´Ğ¾Ñ€Ñ‹</div><div class="amhdr-s">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞ°Ğ¹ â€” Ñ€Ğ°ÑÑ‚Ğ¸ Ğ² Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³Ğµ</div></div></div>
    <div class="amprof">
      <div class="ampt"><div class="amav" id="amav">A</div><div><div class="amname" id="amname">â€”</div><div class="amlvl" id="amlvl">ğŸ‘‹ ĞŸÑ€Ğ¸ÑÑ‚ĞµĞ»ÑŒ</div></div></div>
      <div class="amstats">
        <div class="asb"><div class="asn" id="arefs">0</div><div class="asl">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¾</div></div>
        <div class="asb"><div class="asn" id="acols">0</div><div class="asl">ĞŸĞ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº</div></div>
        <div class="asb"><div class="asn" id="apts">0</div><div class="asl">Ğ‘Ğ°Ğ»Ğ»Ğ¾Ğ²</div></div>
      </div>
    </div>
    <div class="sec">Ğ£Ñ€Ğ¾Ğ²Ğ½Ğ¸</div>
    <div class="lvlrow" id="lvlrow"></div>
    <div class="pgbox"><div class="pgt" id="pgt">Ğ”Ğ¾ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ³Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ</div><div class="pgbar"><div class="pgfill" id="pgfill"></div></div><div class="pgs" id="pgs">ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞ°Ğ¹Ñ‚Ğµ Ğ´Ñ€ÑƒĞ·ĞµĞ¹ Ğ¿Ğ¾ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑÑÑ‹Ğ»ĞºĞµ</div></div>
    <div class="amref">
      <div class="amrh"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑÑ‹Ğ»ĞºĞ°</div>
      <div class="amrl" id="reflbtn" onclick="cpRef()">
        <span id="refl">t.me/navigationinvestat_bot?start=ref_...</span>
        <div id="reflico" style="flex-shrink:0;display:flex;align-items:center;gap:4px;font-size:11px;font-weight:600;color:#7777aa;padding:5px 8px;border-radius:7px;border:1px solid rgba(255,255,255,.11);background:#111122;transition:all .25s">
          <svg id="reflsvg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
          <span id="refltxt">ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ</span>
        </div>
      </div>
    </div>
    <div class="sec">Ğ ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ <span id="lb-status" style="font-size:10px;color:#3d5af1;font-family:Manrope;font-weight:600;text-transform:none;letter-spacing:0"></span></div>
    <div class="lb" id="lbd"><div class="lb-loading">Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³Ğ°...</div></div>
    <div class="sec">ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½ Ğ±Ğ°Ğ»Ğ»Ğ¾Ğ²</div>
    <div class="shoprow">
      <div class="shopc" onclick="showT('Ğ¡ĞºĞ¾Ñ€Ğ¾')"><div class="shopi" style="background:linear-gradient(135deg,#0a1855,#1e3a8a)"><svg width="36" height="36" viewBox="0 0 60 60"><use href="#i-build" color="white"/></svg></div><div class="shopb"><div class="shopn">ĞšÑƒÑ€Ñ Â«Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€Â»</div><div class="shopp">50 000 Ğ±Ğ°Ğ»Ğ»Ğ¾Ğ²</div></div></div>
      <div class="shopc" onclick="showT('Ğ¡ĞºĞ¾Ñ€Ğ¾')"><div class="shopi" style="background:linear-gradient(135deg,#1a0840,#2a1260)"><svg width="36" height="36" viewBox="0 0 60 60"><use href="#i-chart" color="white"/></svg></div><div class="shopb"><div class="shopn">Ğ Ğ°Ğ·Ğ±Ğ¾Ñ€ Ğ¿Ğ¾Ñ€Ñ‚Ñ„ĞµĞ»Ñ</div><div class="shopp">25 000 Ğ±Ğ°Ğ»Ğ»Ğ¾Ğ²</div></div></div>
      <div class="shopc" onclick="showT('Ğ¡ĞºĞ¾Ñ€Ğ¾')"><div class="shopi" style="background:linear-gradient(135deg,#062a18,#0a3a22)"><svg width="36" height="36" viewBox="0 0 60 60"><use href="#i-coin" color="white"/></svg></div><div class="shopb"><div class="shopn">VIP-ĞºĞ¾Ğ½ÑÑƒĞ»ÑŒÑ‚Ğ°Ñ†Ğ¸Ñ</div><div class="shopp">100 000 Ğ±Ğ°Ğ»Ğ»Ğ¾Ğ²</div></div></div>
    </div>
    <div class="amout" onclick="doLogout()">Ğ’Ñ‹Ğ¹Ñ‚Ğ¸ Ğ¸Ğ· Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ°</div>
  </div>

  <nav class="bnav">
    <button class="ntab on" onclick="gt('home',this)"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg><span class="ntabl">Ğ”Ğ¾Ğ¼Ğ¾Ğ¹</span></button>
    <button class="ntab" onclick="gt('community',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg><span class="ntabl">Ğ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğµ</span></button>
    <button class="ntab" onclick="gt('projects',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/></svg><span class="ntabl">ĞŸÑ€Ğ¾ĞµĞºÑ‚Ñ‹</span></button>
    <button class="ntab" onclick="gt('collections',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><span class="ntabl">ĞŸĞ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸</span></button>
    <button class="ntab" onclick="gt('ambassadors',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span class="ntabl">ĞĞ¼Ğ±Ğ°ÑÑĞ°Ğ´Ğ¾Ñ€Ñ‹</span></button>
  </nav>

  <!-- â˜… ĞšĞĞĞŸĞšĞ ĞĞ”ĞœĞ˜ĞĞ˜Ğ¡Ğ¢Ğ ĞĞ¢ĞĞ Ğ â€” Ğ²Ğ¸Ğ´Ğ½Ğ° Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‚ĞµĞ±Ğµ -->
  <button id="admin-fab" onclick="openAdmin()" style="display:none;position:fixed;bottom:calc(var(--tab)+16px);right:16px;width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,#3d5af1,#6366f1);border:none;cursor:pointer;z-index:200;box-shadow:0 4px 20px rgba(61,90,241,.5);align-items:center;justify-content:center">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
  </button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ĞĞ”ĞœĞ˜Ğ ĞŸĞĞĞ•Ğ›Ğ¬
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="admin-panel" style="display:none;position:fixed;inset:0;background:#07070f;z-index:300;overflow-y:auto;-webkit-overflow-scrolling:touch">
  <div style="padding:14px 16px;display:flex;align-items:center;gap:10px;border-bottom:1px solid rgba(255,255,255,.07);position:sticky;top:0;background:#07070f;z-index:10">
    <button onclick="closeAdmin()" style="width:36px;height:36px;border-radius:10px;background:#1c1c2e;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#aaa">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="m15 18-6-6 6-6"/></svg>
    </button>
    <span style="font-family:Unbounded;font-size:14px;font-weight:700;color:#eeeeff;flex:1">ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ</span>
    <span style="font-size:10px;background:rgba(61,90,241,.2);color:#818cf8;padding:3px 8px;border-radius:6px;font-weight:600">ADMIN</span>
  </div>

  <!-- Ğ’ĞºĞ»Ğ°Ğ´ĞºĞ¸ -->
  <div style="display:flex;gap:0;border-bottom:1px solid rgba(255,255,255,.07);padding:0 16px">
    <button class="adm-tab on" onclick="admTab('posts',this)" id="atab-posts">ğŸ“ ĞŸĞ¾ÑÑ‚Ñ‹</button>
    <button class="adm-tab" onclick="admTab('users',this)" id="atab-users">ğŸ‘¥ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸</button>
  </div>

  <!-- â˜… Ğ’ĞšĞ›ĞĞ”ĞšĞ ĞŸĞĞ¡Ğ¢ĞĞ’ -->
  <div id="adm-posts" style="padding:16px">
    <div style="background:#111122;border-radius:14px;padding:16px;margin-bottom:16px;border:1px solid rgba(255,255,255,.07)">
      <div style="font-size:13px;font-weight:700;color:#eeeeff;margin-bottom:14px">â• ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾ÑÑ‚</div>

      <div class="adm-field">
        <label>Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº *</label>
        <input id="ap-title" placeholder="ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: ĞĞ¿Ğ°Ñ€Ñ‚-Ğ¾Ñ‚ĞµĞ»ÑŒ Ğ² Ğ¡Ğ¾Ñ‡Ğ¸ â€” 67% Ğ³Ğ¾Ğ´Ğ¾Ğ²Ñ‹Ñ…">
      </div>
      <div class="adm-field">
        <label>Ğ¢ĞµĞºÑÑ‚ Ğ¿Ğ¾ÑÑ‚Ğ° * (ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹ Ğ¸Ğ· Telegram)</label>
        <textarea id="ap-content" rows="5" placeholder="Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ñ‚ĞµĞºÑÑ‚ Ğ¿Ğ¾ÑÑ‚Ğ° Ğ¸Ğ· Telegram ĞºĞ°Ğ½Ğ°Ğ»Ğ°..."></textarea>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <div class="adm-field">
          <label>ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ *</label>
          <select id="ap-cat">
            <option>Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸</option>
            <option>ĞšĞµĞ¹ÑÑ‹</option>
            <option>Ğ’Ğ¸Ğ´ĞµĞ¾</option>
            <option>ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°</option>
            <option>ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸</option>
            <option>ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ</option>
          </select>
        </div>
        <div class="adm-field">
          <label>Ğ¢Ğ¸Ğ¿</label>
          <select id="ap-type">
            <option value="invest">Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸</option>
            <option value="case">ĞšĞµĞ¹Ñ</option>
            <option value="video">Ğ’Ğ¸Ğ´ĞµĞ¾</option>
            <option value="post">ĞŸĞ¾ÑÑ‚</option>
            <option value="news">ĞĞ¾Ğ²Ğ¾ÑÑ‚ÑŒ</option>
          </select>
        </div>
      </div>
      <div class="adm-field">
        <label>Ğ¢ĞµĞ³Ğ¸ (Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ¿ÑÑ‚ÑƒÑ)</label>
        <input id="ap-tags" placeholder="ÑĞ¾Ñ‡Ğ¸, Ğ°Ğ¿Ğ°Ñ€Ñ‚Ñ‹, Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ">
      </div>
      <div class="adm-field">
        <label>Ğ¡ÑÑ‹Ğ»ĞºĞ° Ğ½Ğ° Telegram Ğ¿Ğ¾ÑÑ‚</label>
        <input id="ap-link" placeholder="https://t.me/..." value="https://t.me/+c4ekMHlWBbQzYjUy">
      </div>
      <div class="adm-field">
        <label>ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº (Ğ¼ĞµĞ½ÑŒÑˆĞµ = Ğ²Ñ‹ÑˆĞµ)</label>
        <input id="ap-order" type="number" placeholder="1" value="">
      </div>
      <button class="adm-btn" onclick="admAddPost()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        ĞĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ÑÑ‚
      </button>
    </div>

    <!-- Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾ÑÑ‚Ğ¾Ğ² -->
    <div style="font-size:11px;font-weight:700;color:#7777aa;text-transform:uppercase;letter-spacing:.06em;margin-bottom:10px">ĞĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ¾ÑÑ‚Ñ‹</div>
    <div id="adm-posts-list"></div>
  </div>

  <!-- â˜… Ğ’ĞšĞ›ĞĞ”ĞšĞ ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ•Ğ™ -->
  <div id="adm-users" style="padding:16px;display:none">
    <div style="font-size:11px;font-weight:700;color:#7777aa;text-transform:uppercase;letter-spacing:.06em;margin-bottom:12px">Ğ’ÑĞµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸</div>
    <div id="adm-users-list"><div style="text-align:center;padding:24px;color:#7777aa">Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...</div></div>
  </div>
</div>

  <div id="det">
  <div class="dhead">
    <button class="dback" onclick="closeDet()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="m15 18-6-6 6-6"/></svg></button>
    <span class="dht" id="dht">ĞœĞ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»</span>
    <button class="favbtn" id="dfav" onclick="togDF()" style="width:32px;height:32px;color:#555"><svg id="dfsvg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></button>
  </div>
  <div class="dhero" id="dhero"><div class="dhero-ov"></div><svg id="dhsvg" width="110" height="110" viewBox="0 0 60 60" style="position:relative;z-index:1"></svg></div>
  <div class="dcnt">
    <div class="dbadges" id="dbd"></div>
    <div class="dtitle" id="dtit"></div>
    <div class="dbody" id="dbody"></div>
    <div class="dtags" id="dtags"></div>
    <!-- â˜… White buttons matching screenshot -->
    <div class="dactions">
      <a class="dbtn btn-watch" id="dwatch" href="#" target="_blank">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>
        Ğ¡Ğ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ
      </a>
      <a class="dbtn btn-consp" id="dconsp" href="#" target="_blank">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
        ĞšĞ¾Ğ½ÑĞ¿ĞµĞºÑ‚
      </a>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// â•â•â•â• Telegram init â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  try{const tg=window.Telegram?.WebApp;if(tg){tg.ready();tg.expand();tg.setHeaderColor('#07070f');tg.setBackgroundColor('#07070f');}}catch(e){}
  const fd=()=>{
    document.documentElement.style.cssText='background:#07070f!important;background-color:#07070f!important;color-scheme:dark!important';
    document.body.style.cssText='background:#07070f!important;background-color:#07070f!important;color:#eeeeff!important';
    document.querySelectorAll('input').forEach(i=>{i.style.cssText=(i.style.cssText||'')+';background:#18182a!important;background-color:#18182a!important;box-shadow:inset 0 0 0 1000px #18182a!important;color:#eeeeff!important;-webkit-text-fill-color:#eeeeff!important;'});
  };
  fd();setTimeout(fd,100);setTimeout(fd,500);setTimeout(fd,1200);
})();

// â•â•â•â• CONTENT DATA â€” Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ÑÑ Ğ¸Ğ· Firestore â•â•â•â•â•â•
// Ğ”ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğµ Ğ¿Ğ¾ÑÑ‚Ñ‹ (Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ Ğ¿Ğ¾ĞºĞ° Firestore Ğ½Ğµ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ğ»ÑÑ)
const POSTS_DEFAULT=[
  {id:'1',title:'Ğ”Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ°Ñ Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ: Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹ Ñ 40â€“67% Ğ³Ğ¾Ğ´Ğ¾Ğ²Ñ‹Ñ…',
   content:'ĞŸĞ¾Ñ€Ñ‚Ğ°Ğ» INVESTAT ÑĞ¾Ğ±Ñ€Ğ°Ğ» Ğ»ÑƒÑ‡ÑˆĞ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹ Ñ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´Ñ‘Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸.\n\nĞšĞ°Ğº Ğ¾Ñ‚Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹:\nâ€¢ Ğ®Ñ€Ğ¸Ğ´Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ‡Ğ¸ÑÑ‚Ğ¾Ñ‚Ğ° Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ°\nâ€¢ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ„Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ğ¾Ğ¹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ·Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‰Ğ¸ĞºĞ°\nâ€¢ ĞĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ° Ñ€Ñ‹Ğ½Ğ¾Ñ‡Ğ½Ğ¾Ğ¹ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸\nâ€¢ Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚ Ğ¸Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€Ğ°Ğ¼\n\nĞ¢Ğ¾Ğ¿-Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹:\n1. ĞĞ¿Ğ°Ñ€Ñ‚-Ğ¾Ñ‚ĞµĞ»ÑŒ Ğ² Ğ¡Ğ¾Ñ‡Ğ¸ â€” 67% Ğ³Ğ¾Ğ´Ğ¾Ğ²Ñ‹Ñ…\n2. ĞšĞ¾Ñ‚Ñ‚ĞµĞ´Ğ¶Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾ÑÑ‘Ğ»Ğ¾Ğº ĞœĞ â€” 54% Ğ³Ğ¾Ğ´Ğ¾Ğ²Ñ‹Ñ…\n3. Ğ¢Ğ¾Ñ€Ğ³Ğ¾Ğ²Ñ‹Ğµ Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´Ğ¸ Ğ¡ĞŸĞ± â€” 41% Ğ³Ğ¾Ğ´Ğ¾Ğ²Ñ‹Ñ…',
   cat:'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸',tags:'Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ,Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ,Ğ¸Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸',type:'invest',ico:'i-coin',bg:'linear-gradient(135deg,#0a1855,#1e3a8a)',order:1,
   tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',tgConsp:'https://t.me/+c4ekMHlWBbQzYjUy'},
  {id:'2',title:'ĞšĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ğ° Ğ² Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞµ vs Ğ°Ğ¿Ğ°Ñ€Ñ‚-Ğ¾Ñ‚ĞµĞ»ÑŒ â€” Ğ³Ğ´Ğµ Ğ²Ñ‹Ğ³Ğ¾Ğ´Ğ½ĞµĞµ',
   content:'Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ» Ğ´Ğ²Ğ° Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° Ñ Ğ¾Ğ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²Ñ‹Ğ¼ Ğ±ÑĞ´Ğ¶ĞµÑ‚Ğ¾Ğ¼ â€” 5 000 000 â‚½.\n\nğŸ¢ ĞšĞ²Ğ°Ñ€Ñ‚Ğ¸Ñ€Ğ° Ğ² ĞœĞ:\nâ€¢ Ğ Ğ¾ÑÑ‚ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ·Ğ° 2 Ğ³Ğ¾Ğ´Ğ°: +18%\nâ€¢ ĞÑ€ĞµĞ½Ğ´Ğ°: 35 000 â‚½/Ğ¼ĞµÑ\nâ€¢ Ğ”Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ: ~22% Ğ³Ğ¾Ğ´Ğ¾Ğ²Ñ‹Ñ…\n\nğŸ¨ ĞĞ¿Ğ°Ñ€Ñ‚-Ğ¾Ñ‚ĞµĞ»ÑŒ Ğ² Ğ¡Ğ¾Ñ‡Ğ¸:\nâ€¢ Ğ Ğ¾ÑÑ‚ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸: +31%\nâ€¢ ĞÑ€ĞµĞ½Ğ´Ğ½Ñ‹Ğ¹ Ğ´Ğ¾Ñ…Ğ¾Ğ´: 58 000 â‚½/Ğ¼ĞµÑ\nâ€¢ Ğ”Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ: ~47% Ğ³Ğ¾Ğ´Ğ¾Ğ²Ñ‹Ñ…\n\nĞ’Ñ‹Ğ²Ğ¾Ğ´: Ğ°Ğ¿Ğ°Ñ€Ñ‚-Ğ¾Ñ‚ĞµĞ»ÑŒ Ğ¾Ğ±Ğ³Ğ¾Ğ½ÑĞµÑ‚ ĞºĞ»Ğ°ÑÑĞ¸Ñ‡ĞµÑĞºÑƒÑ Ğ°Ñ€ĞµĞ½Ğ´Ñƒ Ğ² 2+ Ñ€Ğ°Ğ·Ğ°.',
   cat:'ĞšĞµĞ¹ÑÑ‹',tags:'ĞºĞµĞ¹Ñ,Ğ°Ğ¿Ğ°Ñ€Ñ‚-Ğ¾Ñ‚ĞµĞ»ÑŒ,ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ',type:'case',ico:'i-build',bg:'linear-gradient(135deg,#1a0840,#3a1a80)',order:2,
   tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',tgConsp:'https://t.me/+c4ekMHlWBbQzYjUy'},
  {id:'3',title:'Ğ’Ğ¸Ğ´ĞµĞ¾: Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ñ‹Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ â€” ĞºĞ°Ğº Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿',
   content:'Ğ Ğ°ÑÑĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ, ĞºĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ INVESTAT.\n\nĞ§Ñ‚Ğ¾ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸:\nâ€” ĞšĞ°Ğº Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ±Ğ°Ğ·Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ²\nâ€” ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ñ‡Ğ°ÑÑ‚ÑŒ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ¾Ğ² Ğ²Ğ¸Ğ´Ğ½Ğ° Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ°Ğ¼\nâ€” Ğ ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ¸Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€Ğ¾Ğ²\nâ€” ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ²Ñ…Ğ¾Ğ´Ğ° Ğ² Ğ¿Ñ€Ğ¾ĞµĞºÑ‚\n\nĞ¢Ğ°ĞºĞ¶Ğµ Ñ€Ğ°Ğ·Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼:\nâœ… ĞšĞ°Ğº Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ„Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²ÑƒÑ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ\nâœ… ĞĞ° Ñ‡Ñ‚Ğ¾ ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ² Ğ´Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğµ\nâœ… ĞšĞ¾Ğ³Ğ´Ğ° Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ Ğ¸Ğ· Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°',
   cat:'Ğ’Ğ¸Ğ´ĞµĞ¾',tags:'Ğ²Ğ¸Ğ´ĞµĞ¾,Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ',type:'video',ico:'i-play',bg:'linear-gradient(135deg,#0a3020,#1a6040)',order:3,
   tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',tgConsp:'https://t.me/+c4ekMHlWBbQzYjUy'},
  {id:'4',title:'ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ñ€Ñ‹Ğ½ĞºĞ° Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ 2025',
   content:'Ğ‘Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¾Ğ±Ğ·Ğ¾Ñ€ Ğ½Ğ° 2025 Ğ³Ğ¾Ğ´.\n\nğŸ“ˆ Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ½Ğ´Ñ‹:\n1. ĞĞ¿Ğ°Ñ€Ñ‚-Ğ¾Ñ‚ĞµĞ»Ğ¸ Ğ² Ñ‚ÑƒÑ€Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ·Ğ¾Ğ½Ğ°Ñ… â€” Ñ€Ğ¾ÑÑ‚ ÑĞ¿Ñ€Ğ¾ÑĞ° +34%\n2. ĞšĞ¾Ğ¼Ğ¼ĞµÑ€Ñ‡ĞµÑĞºĞ°Ñ Ğ½ĞµĞ´Ğ²Ğ¸Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ² Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½Ğ°Ñ… â€” Ğ½ĞµĞ´Ğ¾Ğ¾Ñ†ĞµĞ½Ñ‘Ğ½Ğ½Ñ‹Ğ¹ ÑĞµĞ³Ğ¼ĞµĞ½Ñ‚\n3. ĞšÑ€Ğ°ÑƒĞ´Ğ»ĞµĞ½Ğ´Ğ¸Ğ½Ğ³ â€” Ğ¾Ğ±ÑŠÑ‘Ğ¼ Ñ€Ñ‹Ğ½ĞºĞ° ÑƒĞ´Ğ²Ğ¾Ğ¸Ğ»ÑÑ',
   cat:'ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°',tags:'Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°,2025,Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·',type:'post',ico:'i-chart',bg:'linear-gradient(135deg,#301000,#602008)',order:4,
   tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',tgConsp:'https://t.me/+c4ekMHlWBbQzYjUy'},
  {id:'5',title:'ĞĞ¾Ğ²Ğ¾ÑÑ‚ÑŒ: Ğ¦Ğ‘ ÑƒĞ¶ĞµÑÑ‚Ğ¾Ñ‡Ğ°ĞµÑ‚ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº Ğ¸Ğ½Ğ²ĞµÑÑ‚-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ°Ğ¼',
   content:'Ğ‘Ğ°Ğ½Ğº Ğ Ğ¾ÑÑĞ¸Ğ¸ Ğ²Ğ²Ñ‘Ğ» Ğ½Ğ¾Ğ²Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº Ğ·Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‰Ğ¸ĞºĞ°Ğ¼ Ğ¸ Ğ¸Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğ¼ Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ°Ğ¼.',
   cat:'ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸',tags:'Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚Ğ¸,Ğ¦Ğ‘',type:'news',ico:'i-news',bg:'linear-gradient(135deg,#002030,#004060)',order:5,
   tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',tgConsp:'https://t.me/+c4ekMHlWBbQzYjUy'},
  {id:'6',title:'ĞšĞµĞ¹Ñ: 2 400 000 â‚½ Ğ·Ğ° 18 Ğ¼ĞµÑÑÑ†ĞµĞ²',
   content:'Ğ¡Ñ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ°Ğ¿Ğ¸Ñ‚Ğ°Ğ»: 3 600 000 â‚½. ĞĞ±ÑŠĞµĞºÑ‚: Ğ°Ğ¿Ğ°Ñ€Ñ‚Ğ°Ğ¼ĞµĞ½Ñ‚Ñ‹ Ğ² Ğ¡Ğ¾Ñ‡Ğ¸. Ğ¡Ñ€Ğ¾Ğº: 18 Ğ¼ĞµÑÑÑ†ĞµĞ².\n\nğŸ’° Ğ˜Ñ‚Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¸Ğ±Ñ‹Ğ»Ğ¸: 2 400 000 â‚½\nğŸ”¢ Ğ”Ğ¾Ñ…Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ: 44,4% Ğ³Ğ¾Ğ´Ğ¾Ğ²Ñ‹Ñ…',
   cat:'ĞšĞµĞ¹ÑÑ‹',tags:'ĞºĞµĞ¹Ñ,Ğ¡Ğ¾Ñ‡Ğ¸,Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚',type:'case',ico:'i-build',bg:'linear-gradient(135deg,#0a2010,#1a5030)',order:6,
   tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',tgConsp:'https://t.me/+c4ekMHlWBbQzYjUy'},
  {id:'7',title:'Ğ§ĞµĞº-Ğ»Ğ¸ÑÑ‚: 12 Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ¿ĞµÑ€ĞµĞ´ Ğ²Ñ…Ğ¾Ğ´Ğ¾Ğ¼ Ğ² Ğ¿Ñ€Ğ¾ĞµĞºÑ‚',
   content:'Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸ â€” ÑÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ‚ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ Ğ¸ Ğ½ĞµÑ€Ğ²Ñ‹.\n\nğŸ“‹ Ğ®Ñ€Ğ¸Ğ´Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ‡Ğ°ÑÑ‚ÑŒ:\nâ˜ ĞŸÑ€Ğ°Ğ²Ğ¾ ÑĞ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ½Ğ° Ğ·ĞµĞ¼Ğ»Ñ\nâ˜ Ğ Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ½Ğ° ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ĞµĞ»ÑŒÑÑ‚Ğ²Ğ¾\nâ˜ Ğ”Ğ¾Ğ³Ğ¾Ğ²Ğ¾Ñ€ Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑÑÑ‰ĞµĞ¹ ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸ĞµĞ¹\nâ˜ Ğ­ÑĞºÑ€Ğ¾Ñƒ-ÑÑ‡Ñ‘Ñ‚ Ğ¸Ğ»Ğ¸ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ğ¸',
   cat:'ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ',tags:'Ñ‡ĞµĞº-Ğ»Ğ¸ÑÑ‚,Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°',type:'post',ico:'i-edu',bg:'linear-gradient(135deg,#1a0820,#401060)',order:7,
   tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',tgConsp:'https://t.me/+c4ekMHlWBbQzYjUy'},
];

// Ğ–Ğ¸Ğ²Ğ¾Ğ¹ Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ¿Ğ¾ÑÑ‚Ğ¾Ğ² (Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ Ğ¸Ğ· Firestore)
let POSTS = [...POSTS_DEFAULT];

// ĞšĞ°Ñ€Ñ‚Ğ° Ğ¸ĞºĞ¾Ğ½Ğ¾Ğº Ğ¸ Ñ†Ğ²ĞµÑ‚Ğ¾Ğ² Ğ¿Ğ¾ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ (Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ)
const CAT_META = {
  'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸': {ico:'i-coin',  bg:'linear-gradient(135deg,#0a1855,#1e3a8a)'},
  'ĞšĞµĞ¹ÑÑ‹':      {ico:'i-build', bg:'linear-gradient(135deg,#1a0840,#3a1a80)'},
  'Ğ’Ğ¸Ğ´ĞµĞ¾':      {ico:'i-play',  bg:'linear-gradient(135deg,#0a3020,#1a6040)'},
  'ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°':  {ico:'i-chart', bg:'linear-gradient(135deg,#301000,#602008)'},
  'ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸':    {ico:'i-news',  bg:'linear-gradient(135deg,#002030,#004060)'},
  'ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ':   {ico:'i-edu',   bg:'linear-gradient(135deg,#1a0820,#401060)'},
};

// ĞŸĞ¾Ğ´ÑÑ‡Ñ‘Ñ‚ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹ Ğ¸Ğ· Ğ¶Ğ¸Ğ²Ñ‹Ñ… Ğ¿Ğ¾ÑÑ‚Ğ¾Ğ²
function buildCATS(){
  const cats = {};
  POSTS.forEach(p=>{
    if(!cats[p.cat]) cats[p.cat] = {...(CAT_META[p.cat]||{ico:'i-coin',bg:'linear-gradient(135deg,#0a1855,#1e3a8a)'}), cnt:0};
    cats[p.cat].cnt++;
  });
  return cats;
}
let CATS = buildCATS();

// â•â•â•â• Ğ—ĞĞ“Ğ Ğ£Ğ—ĞšĞ ĞŸĞĞ¡Ğ¢ĞĞ’ Ğ˜Ğ— FIRESTORE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _postsUnsub = null;
function fsLoadPosts(){
  if(!window.__firebaseReady){ return; }
  if(_postsUnsub){ _postsUnsub(); _postsUnsub=null; }
  try{
    const colRef = window.__fsCollection(window.__FS, 'posts');
    _postsUnsub = window.__fsOnSnapshot(colRef, snap => {
      const loaded = [];
      snap.forEach(d => {
        const p = d.data();
        if(p.published === false) return; // ÑĞºÑ€Ñ‹Ñ‚Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼
        const meta = CAT_META[p.cat] || {ico:'i-coin', bg:'linear-gradient(135deg,#0a1855,#1e3a8a)'};
        loaded.push({
          id:      d.id,
          title:   p.title   || 'Ğ‘ĞµĞ· Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ',
          content: p.content || '',
          cat:     p.cat     || 'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸',
          tags:    p.tags    || '',
          type:    p.type    || 'post',
          ico:     p.ico     || meta.ico,
          bg:      p.bg      || meta.bg,
          order:   typeof p.order === 'number' ? p.order : 99,
          tgLink:  p.tgLink  || 'https://t.me/+c4ekMHlWBbQzYjUy',
          tgConsp: p.tgConsp || 'https://t.me/+c4ekMHlWBbQzYjUy',
        });
      });
      // â˜… Ğ’ĞĞ–ĞĞ: Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ğµ Ğ¿Ğ¾ÑÑ‚Ñ‹ â€” Ğ·Ğ°Ğ¼ĞµĞ½ÑĞµĞ¼ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğµ
      // Ğ˜Ğ½Ğ°Ñ‡Ğµ Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµĞ¼ POSTS_DEFAULT Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ³Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ğ½Ğµ Ğ±Ñ‹Ğ»Ğ° Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹
      if(loaded.length > 0){
        POSTS = loaded.sort((a,b) => a.order - b.order);
      } else {
        POSTS = [...POSTS_DEFAULT]; // Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğµ
      }
      CATS = buildCATS();
      if(document.getElementById('page-home')?.classList.contains('active')){
        renderHome();
      }
    }, err=>{
      console.warn('fsLoadPosts error:', err.message);
      // ĞŸÑ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğµ ÑƒĞ¶Ğµ ÑÑ‚Ğ¾ÑÑ‚ â€” Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾ Ğ½Ğµ Ğ´ĞµĞ»Ğ°ĞµĞ¼
    });
  }catch(e){ console.warn('fsLoadPosts exception:', e); }
}
const AVCOLORS=['#0a1855','#1a0840','#0a3020','#301000','#002030','#1a0820','#0f1f60','#2a0a40'];
const LEVELS=[
  {name:'ĞŸÑ€Ğ¸ÑÑ‚ĞµĞ»ÑŒ',req:0, emoji:'ğŸ‘‹'},
  {name:'ĞŸĞ°Ñ€Ñ‚Ğ½Ñ‘Ñ€', req:3, emoji:'ğŸ¤'},
  {name:'Ğ­ĞºÑĞ¿ĞµÑ€Ñ‚', req:10,emoji:'â­'},
  {name:'Ğ¢Ğ¾Ğ¿',     req:25,emoji:'ğŸ†'},
];

// â•â•â•â• STATE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let CU=null,FAVS=new Set(),HFT='all',HST=null,CID=null;

// â•â•â•â• STORAGE (localStorage) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const gU=()=>{try{return JSON.parse(localStorage.getItem('iv_u')||'{}')}catch{return{}}};
const sU=u=>localStorage.setItem('iv_u',JSON.stringify(u));
const gS=()=>{try{return JSON.parse(localStorage.getItem('iv_s')||'null')}catch{return null}};
const sS=u=>localStorage.setItem('iv_s',JSON.stringify(u));
const cSess=()=>localStorage.removeItem('iv_s');
const gF=id=>{try{return new Set(JSON.parse(localStorage.getItem('iv_f_'+id)||'[]'))}catch{return new Set()}};
const svF=(id,s)=>localStorage.setItem('iv_f_'+id,JSON.stringify([...s]));
const hash=s=>{let h=0;for(let i=0;i<s.length;i++)h=Math.imul(31,h)+s.charCodeAt(i)|0;return h.toString(36)};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FIRESTORE â€” Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ + Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°
// ĞšĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ: "users" â†’ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚: uid Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
// ĞŸĞ¾Ğ»Ñ: name, refs, pts, col, createdAt
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Ğ–Ğ´Ñ‘Ğ¼ Ğ¿Ğ¾ĞºĞ° Firebase module Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ
function waitFS(cb, attempts=0){
  if(window.__firebaseReady){ cb(); return; }
  if(attempts > 30){ console.warn('Firestore not ready'); cb(); return; }
  setTimeout(()=>waitFS(cb, attempts+1), 100);
}

// Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ/Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ² Firestore
async function fsSaveUser(u){
  if(!window.__firebaseReady) return;
  try{
    const tgU = window.__tgUser || {};
    const now  = new Date();
    const ref  = window.__fsDoc(window.__FS, 'users', String(u.id));

    // Ğ§Ğ¸Ñ‚Ğ°ĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğµ Ğ·Ğ°Ñ‚ĞµÑ€ĞµÑ‚ÑŒ createdAt
    let createdAt = window.__fsTs();
    try{
      const snap = await window.__fsGetDoc(ref);
      if(snap.exists()) createdAt = snap.data().createdAt || window.__fsTs();
    }catch(e){}

    await window.__fsSetDoc(ref, {
      // â•â• Ğ˜Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ â•â•
      id:           String(u.id),
      telegramId:   tgU.id   || u.id || '',
      username:     u.username || tgU.username || '',

      // â•â• Ğ›Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ â•â•
      name:         u.name  || 'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€',
      firstName:    tgU.firstName || u.name?.split(' ')[0] || '',
      lastName:     tgU.lastName  || u.name?.split(' ')[1] || '',
      phone:        u.phone || '',
      email:        u.email || '',

      // â•â• Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° â•â•
      refs:         u.refs  || 0,
      refLink:      `https://t.me/navigationinvestat_bot?start=ref_${u.id}`,
      invitedBy:    sessionStorage.getItem('ref_from') || '',

      // â•â• Ğ‘Ğ°Ğ»Ğ»Ñ‹ Ğ¸ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ â•â•
      pts:          u.pts   || 0,
      level:        _getLevelName(u.refs || 0),

      // â•â• ĞĞ²Ğ°Ñ‚Ğ°Ñ€ â•â•
      col:          u.col   || '#3d5af1',
      photoUrl:     tgU.photo || '',

      // â•â• ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ â•â•
      favorites:    u.favs  || 0,
      lastSeen:     now.toISOString(),
      timezone:     Intl.DateTimeFormat().resolvedOptions().timeZone || '',
      locale:       navigator.language || '',
      platform:     navigator.userAgent.includes('iPhone')||navigator.userAgent.includes('iPad') ? 'iOS'
                    : navigator.userAgent.includes('Android') ? 'Android' : 'Web',

      // â•â• Timestamps â•â•
      createdAt:    createdAt,
      updatedAt:    window.__fsTs(),
    }, { merge: true });

  } catch(e){ console.warn('fsSaveUser error:', e.message); }
}

// ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ Ğ¿Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ñƒ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¾Ğ²
function _getLevelName(refs){
  if(refs >= 25) return 'ğŸ† Ğ¢Ğ¾Ğ¿';
  if(refs >= 10) return 'â­ Ğ­ĞºÑĞ¿ĞµÑ€Ñ‚';
  if(refs >= 3)  return 'ğŸ¤ ĞŸĞ°Ñ€Ñ‚Ğ½Ñ‘Ñ€';
  return 'ğŸ‘‹ ĞŸÑ€Ğ¸ÑÑ‚ĞµĞ»ÑŒ';
}

// ĞĞ°Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ» Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ²ÑˆĞµĞ¼Ñƒ (Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ¾Ğ¹ Ğ¾Ñ‚ Ğ´ÑƒĞ±Ğ»ĞµĞ¹)
async function fsAddRef(rawInviterId, newUserId){
  if(!window.__firebaseReady) return;

  // ĞĞ¾Ñ€Ğ¼Ğ°Ğ»Ğ¸Ğ·ÑƒĞµĞ¼ â€” ÑƒĞ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ¿Ñ€ĞµÑ„Ğ¸ĞºÑ tg Ğ¸ ref_
  const cleanId = String(rawInviterId).replace('ref_','').replace('tg','');
  console.log('ğŸ¯ fsAddRef: Ğ¸Ñ‰ĞµĞ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ñ ID:', cleanId);

  // Ğ˜Ñ‰ĞµĞ¼ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ â€” Ğ¿Ñ€Ğ¾Ğ±ÑƒĞµĞ¼ Ğ±ĞµĞ· Ğ¿Ñ€ĞµÑ„Ğ¸ĞºÑĞ°, Ñ tg- Ğ¸ Ñ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ñ‹Ğ¼
  let docRef = null;
  for(const tryId of [cleanId, 'tg'+cleanId]){
    try{
      const s = await window.__fsGetDoc(window.__fsDoc(window.__FS,'users',tryId));
      if(s.exists()){ docRef = window.__fsDoc(window.__FS,'users',tryId); console.log('âœ… ĞĞ°ÑˆĞ»Ğ¸:', tryId); break; }
    }catch(e){}
  }

  if(!docRef){
    console.warn('âš ï¸ fsAddRef: Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½, id=', cleanId);
    // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ placeholder Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ» Ğ½Ğµ Ğ¿Ğ¾Ñ‚ĞµÑ€ÑĞ»ÑÑ
    return;
  }

  try{
    const snap = await window.__fsGetDoc(docRef);
    const data = snap.data() || {};
    const newUserStr = String(newUserId).replace('tg','');
    const alreadyReffed = (data.refedUsers || []).some(u => String(u).replace('tg','') === newUserStr);

    if(alreadyReffed){
      console.log('â„¹ï¸ fsAddRef: Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ» ÑƒĞ¶Ğµ Ğ·Ğ°ÑÑ‡Ğ¸Ñ‚Ğ°Ğ½ Ñ€Ğ°Ğ½ĞµĞµ');
      return;
    }

    await window.__fsUpdateDoc(docRef, {
      refs:       window.__fsIncrement(1),
      pts:        window.__fsIncrement(100),
      refedUsers: window.__fsArrayUnion(newUserStr),
    });

    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ localStorage ĞµÑĞ»Ğ¸ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ²ÑˆĞ¸Ğ¹ â€” Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ
    if(CU && (String(CU.id).replace('tg','') === cleanId)){
      CU.refs = (CU.refs||0) + 1;
      CU.pts  = (CU.pts||0) + 100;
      sS(CU);
      const users = gU();
      if(users[CU.id]){ users[CU.id].refs = CU.refs; users[CU.id].pts = CU.pts; sU(users); }
      updateUI();
    }
    console.log('âœ… Ğ ĞµÑ„ĞµÑ€Ğ°Ğ» Ğ·Ğ°ÑÑ‡Ğ¸Ñ‚Ğ°Ğ½! ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ²ÑˆĞ¸Ğ¹:', cleanId, 'â† Ğ½Ğ¾Ğ²Ñ‹Ğ¹:', newUserStr);
    showT('ğŸ‰ +1 Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ» Ğ·Ğ°ÑÑ‡Ğ¸Ñ‚Ğ°Ğ½!');
  }catch(e){ console.warn('fsAddRef error:', e.message); }
}

// ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ (live Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ)
let _lbUnsub = null;
function fsListenLeaderboard(){
  if(!window.__firebaseReady){ renderLBFallback(); return; }
  // ĞÑ‚Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµĞ¼ÑÑ Ğ¾Ñ‚ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ¹ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸
  if(_lbUnsub){ _lbUnsub(); _lbUnsub=null; }
  try{
    const colRef = window.__fsCollection(window.__FS, 'users');
    _lbUnsub = window.__fsOnSnapshot(colRef, snap => {
      const arr = [];
      snap.forEach(d => {
        const u = d.data();
        arr.push({
          id:       d.id,
          name:     u.name     || 'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€',
          username: u.username || '',
          refs:     u.refs     || 0,
          pts:      u.pts      || 0,
          col:      u.col      || '#3d5af1'
        });
      });
      arr.sort((a,b) => b.refs - a.refs || b.pts - a.pts);
      renderLBData(arr.slice(0, 10));
      const st = document.getElementById('lb-status');
      if(st) st.textContent = 'ğŸŸ¢ live';
    }, err => {
      console.warn('Firestore snapshot error:', err.message);
      renderLBFallback();
    });
  } catch(e){ renderLBFallback(); }
}

// Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ ÑÑ‡Ñ‘Ñ‚Ñ‡Ğ¸ĞºĞ¸ Ñ Firestore Ğ¿Ñ€Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ğ²Ñ…Ğ¾Ğ´Ğµ
async function syncUserFromFirestore(){
  if(!window.__firebaseReady || !CU) return;
  try{
    const rawId = String(CU.id).replace('tg','');
    let snap = null;
    for(const tryId of [CU.id, 'tg'+rawId, rawId]){
      try{
        const s = await window.__fsGetDoc(window.__fsDoc(window.__FS, 'users', tryId));
        if(s.exists()){ snap = s; break; }
      }catch(e){}
    }
    if(!snap) return;
    const data = snap.data();
    CU.refs = data.refs ?? CU.refs ?? 0;
    CU.pts  = data.pts  ?? CU.pts  ?? 0;
    sS(CU);
    const users = gU();
    if(users[CU.id]){
      users[CU.id].refs = CU.refs;
      users[CU.id].pts  = CU.pts;
      sU(users);
    }
    document.getElementById('arefs').textContent = CU.refs;
    document.getElementById('apts').textContent  = CU.pts;
    renderLevels();
  }catch(e){ console.warn('syncUserFromFirestore error:', e.message); }
}

// â•â•â•â• BOOT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('load',()=>{
  try{
    const tg = window.Telegram?.WebApp;
    if(tg){
      const tgUser = tg?.initDataUnsafe?.user;
      if(tgUser){
        window.__tgUser = {
          id:       String(tgUser.id),
          name:     [tgUser.first_name, tgUser.last_name].filter(Boolean).join(' ')
                    || tgUser.username || 'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€',
          username: tgUser.username || '',
        };
        const rnEl = document.getElementById('rn');
        if(rnEl && !rnEl.value) rnEl.value = window.__tgUser.name;
      }
      // â˜… Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ â€” Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼ start_param (Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¸ Ğ´Ğ»Ñ ?start= Ğ¸ Ğ´Ğ»Ñ ?startapp=)
      const startParam = tg?.initDataUnsafe?.start_param || '';
      console.log('ğŸ“¦ start_param:', startParam);
      // ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹: ref_123, ref_tg123
      if(startParam && (startParam.startsWith('ref_') || startParam.includes('ref'))){
        const refId = startParam.replace('ref_','').replace('tg','');
        if(refId && refId.length > 3){
          localStorage.setItem('ref_from', refId);
          console.log('ğŸ“ Ğ ĞµÑ„ĞµÑ€Ğ°Ğ» ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½ Ğ¾Ñ‚:', refId);
        }
      }
    }
  }catch(e){ console.warn('boot error:', e); }

  const s = gS();
  if(s){
    CU=s; FAVS=gF(s.id);
    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² Firestore Ğ¿Ñ€Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ğ²Ñ…Ğ¾Ğ´Ğµ
    waitFS(()=>{
      // Ğ•ÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ Telegram Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ â€” Ğ¼Ğ¸Ğ³Ñ€Ğ¸Ñ€ÑƒĞµĞ¼ Ğ½Ğ° TG ID
      const tgU = window.__tgUser;
      if(tgU && tgU.id && CU.id !== tgU.id){
        const users = gU();
        const newU = {...CU, id:tgU.id, name:tgU.name||CU.name, username:tgU.username||CU.username||''};
        delete users[CU.id];
        users[tgU.id] = newU;
        sU(users); sS(newU); CU = newU;
        FAVS = gF(tgU.id);
      }
      fsSaveUser(CU);
    });
    launch();
  }
});

// â•â•â•â• AUTH â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function sw(m){
  const il=m==='l';
  document.getElementById('bl').classList.toggle('on',il);
  document.getElementById('br').classList.toggle('on',!il);
  document.getElementById('fl').style.display=il?'':'none';
  document.getElementById('fr').style.display=il?'none':'';
  ['la','ra'].forEach(id=>document.getElementById(id).classList.remove('show'));
}
function tp(id,btn){const i=document.getElementById(id);i.type=i.type==='password'?'text':'password';btn.style.opacity=i.type==='text'?.7:.32;}
function sh(hid,fid,msg,t){
  const h=document.getElementById(hid),f=fid?document.getElementById(fid):null;
  h.textContent=msg;h.className='hint'+(msg?' '+(t==='er'?'e2':'ok'):'');
  if(f)f.classList.toggle('er',t==='er'&&!!msg);
}
function vN(){const v=document.getElementById('rn').value.trim();if(v&&v.length<2){sh('hn','rn','ĞœĞ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 2 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ°','er');return false;}sh('hn',null,'','');return true;}
function vPh(){const v=document.getElementById('rph').value.replace(/\D/g,'');if(!v){sh('hph','rph','ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ','er');return false;}if(v.length<10){sh('hph','rph','Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€','er');return false;}sh('hph','rph','ĞĞ¾Ğ¼ĞµÑ€ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚ĞµĞ½','ok');return true;}
function vE(){
  const v=document.getElementById('rem').value.trim();
  if(!v){sh('hem','rem','ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ','er');return false;}
  if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v)){sh('hem','rem','ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ email','er');return false;}
  if(Object.values(gU()).find(u=>u.email===v.toLowerCase())){sh('hem','rem','Email ÑƒĞ¶Ğµ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½','er');return false;}
  sh('hem','rem','Email Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½','ok');return true;
}
function vP(){
  const v=document.getElementById('rp').value,sf=document.getElementById('sf');
  if(!v){sh('hp','rp','ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ','er');sf.style.width='0';return false;}
  let s=0;if(v.length>=8)s++;if(/[A-ZĞ-Ğ¯]/.test(v))s++;if(/\d/.test(v))s++;if(/[^a-zA-ZĞ°-ÑĞ-Ğ¯0-9]/.test(v))s++;
  const cs=['#e03050','#e8640a','#d4a011','#0baa6e'],ls=['Ğ¡Ğ»Ğ°Ğ±Ñ‹Ğ¹','Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹','Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğ¹','ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹'];
  sf.style.width=(s*25)+'%';sf.style.background=cs[s-1]||cs[0];
  if(v.length<8){sh('hp','rp','ĞœĞ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 8 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²','er');return false;}
  sh('hp','rp','ĞĞ°Ğ´Ñ‘Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ: '+ls[s-1],'ok');
  if(document.getElementById('rp2').value)vP2();return true;
}
function vP2(){const v=document.getElementById('rp').value,v2=document.getElementById('rp2').value;if(!v2){sh('hp2','rp2','ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ','er');return false;}if(v!==v2){sh('hp2','rp2','ĞŸĞ°Ñ€Ğ¾Ğ»Ğ¸ Ğ½Ğµ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ÑÑ‚','er');return false;}sh('hp2','rp2','ĞŸĞ°Ñ€Ğ¾Ğ»Ğ¸ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ÑÑ‚','ok');return true;}
function showA(id,msg){const e=document.getElementById(id);e.textContent=msg;e.classList.add('show');}

function doLogin(){
  const em=document.getElementById('le').value.trim().toLowerCase(),pw=document.getElementById('lp').value;
  document.getElementById('la').classList.remove('show');
  if(!em||!pw){showA('la','Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ²ÑĞµ Ğ¿Ğ¾Ğ»Ñ');return;}
  const u=Object.values(gU()).find(u=>u.email===em);
  if(!u||u.ph!==hash(pw)){showA('la','ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ email Ğ¸Ğ»Ğ¸ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ');return;}

  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºÑƒ
  waitFS(async ()=>{
    const blocked = await checkBlocked(u.id);
    if(blocked){
      showA('la','âŒ Ğ’Ğ°Ñˆ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½. ĞĞ±Ñ€Ğ°Ñ‚Ğ¸Ñ‚ĞµÑÑŒ Ğº Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ñƒ.');
      return;
    }
    // Ğ•ÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ TG Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ â€” Ğ¼Ğ¸Ğ³Ñ€Ğ¸Ñ€ÑƒĞµĞ¼ Ğ½Ğ° TG ID
    const tgU = window.__tgUser;
    if(tgU && tgU.id && u.id !== tgU.id && String(u.id).startsWith('u')){
      const users = gU();
      const newU = {...u, id: tgU.id, name: tgU.name||u.name, username: tgU.username||''};
      delete users[u.id]; users[tgU.id] = newU;
      sU(users); sS(newU); CU = newU; FAVS = gF(tgU.id);
      fsSaveUser(newU);
    } else {
      CU=u; FAVS=gF(u.id); sS(u);
      fsSaveUser(u);
    }
    launch();
  });
}
function doReg(){
  const a=vPh(),b=vE(),c=vP(),d=vP2();
  document.getElementById('ra').classList.remove('show');
  if(!a||!b||!c||!d){showA('ra','Ğ˜ÑĞ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ²Ñ‹ÑˆĞµ');return;}

  const tgU  = window.__tgUser;
  const nm   = document.getElementById('rn').value.trim() || tgU?.name || 'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€';
  const ph   = document.getElementById('rph').value.replace(/\D/g,'');
  const em   = document.getElementById('rem').value.trim().toLowerCase();
  const pw   = document.getElementById('rp').value;
  const users = gU();

  // â˜… ID = Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğ¹ Telegram ID (ĞºĞ°Ğº Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² start_param)
  const tgRawId = tgU ? String(tgU.id).replace('tg','') : null;
  const id  = tgU?.id || String(Date.now());
  const col = AVCOLORS[Math.floor(Math.random()*AVCOLORS.length)];

  const existing = users[id];
  const u = {
    id,
    tgNumericId: tgRawId || id, // Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğ¹ ID â€” Ğ¸Ğ¼ĞµĞ½Ğ½Ğ¾ Ğ¾Ğ½ Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² start_param
    name:     nm,
    username: tgU?.username || '',
    phone:    ph,
    email:    em,
    ph:       hash(pw),
    refs:     existing?.refs || 0,
    pts:      existing?.pts  || 0,
    col:      existing?.col  || col
  };
  users[id] = u; sU(users);
  CU = u; FAVS = gF(id); sS(u);

  // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ² Firestore
  waitFS(()=>{ fsSaveUser(u); });

  // â˜… ĞĞ°Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ» Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ²ÑˆĞµĞ¼Ñƒ
  const refFrom = localStorage.getItem('ref_from');
  if(refFrom && refFrom !== id && refFrom !== String(id).replace('tg','')){
    console.log('ğŸ¯ ĞĞ°Ñ‡Ğ¸ÑĞ»ÑĞµĞ¼ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ» Ğ´Ğ»Ñ:', refFrom, 'â† Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ:', id);
    waitFS(()=>{ fsAddRef(refFrom, id); });
    localStorage.removeItem('ref_from');
  }

  launch();
  showT('Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² INVESTAT! ğŸ‰');
}
function doLogout(){
  CU=null;FAVS=new Set();cSess();
  document.getElementById('app-screen').classList.remove('active');
  document.getElementById('auth-screen').classList.add('active');
  ['le','lp','rn','rph','rem','rp','rp2'].forEach(id=>{const e=document.getElementById(id);if(e)e.value='';});
  document.getElementById('sf').style.width='0';
  ['hn','hph','hem','hp','hp2'].forEach(id=>{const e=document.getElementById(id);if(e){e.textContent='';e.className='hint';}});
  sw('l');
}

// â•â•â•â• LAUNCH â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function launch(){
  document.getElementById('auth-screen').classList.remove('active');
  document.getElementById('app-screen').classList.add('active');
  updateUI();
  renderHome();
  renderCollections();
  renderLevels();
  loadLeaderboard();
  checkAdminFab();
  waitFS(()=>{
    fsLoadPosts();
    syncUserFromFirestore(); // â† Ğ¿Ğ¾Ğ´Ñ‚ÑĞ³Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ñ‹/Ğ±Ğ°Ğ»Ğ»Ñ‹
  });
}

// â•â•â•â• UI UPDATE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function curLevel(){const refs=CU?.refs||0;let lv=LEVELS[0];for(const l of LEVELS)if(refs>=l.req)lv=l;return lv;}

function updateUI(){
  if(!CU)return;
  const init=(CU.name||'I')[0].toUpperCase();
  document.getElementById('topav').textContent=init;
  document.getElementById('amav').textContent=init;
  document.getElementById('amname').textContent=CU.name||'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€';
  const lv=curLevel();
  document.getElementById('amlvl').textContent=lv.emoji+' '+lv.name;
  document.getElementById('arefs').textContent=CU.refs||0;
  document.getElementById('acols').textContent=FAVS.size;
  document.getElementById('apts').textContent=CU.pts||0;

  // â˜… Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑÑ‹Ğ»ĞºĞ° â€” Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ²Ğ¾Ğ¹ TG ID ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ
  // Telegram Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ start_param Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾ ĞºĞ°Ğº ĞµÑÑ‚ÑŒ, Ğ¿Ğ¾ÑÑ‚Ğ¾Ğ¼Ñƒ ID Ğ² ÑÑÑ‹Ğ»ĞºĞµ
  // Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°Ñ‚ÑŒ Ñ Ñ‚ĞµĞ¼ Ñ‡Ñ‚Ğ¾ Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑÑ Ğ² Firestore ĞºĞ°Ğº ĞºĞ»ÑÑ‡ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°
  const refId = CU.tgNumericId || CU.id;
  const rl = 'https://t.me/navigationinvestat_bot?start=ref_' + refId;
  const reflEl = document.getElementById('refl');
  const hrlEl  = document.getElementById('hrl');
  if(reflEl) reflEl.textContent = rl;
  if(hrlEl)  hrlEl.textContent  = rl;

  // Progress bar
  const refs=CU.refs||0,idx=LEVELS.indexOf(lv),next=LEVELS[idx+1];
  if(next){
    const pct=Math.min(Math.round((refs-lv.req)/(next.req-lv.req)*100),100);
    setTimeout(()=>{const el=document.getElementById('pgfill');if(el)el.style.width=pct+'%';},400);
    const pgt=document.getElementById('pgt');const pgs=document.getElementById('pgs');
    if(pgt)pgt.textContent='Ğ”Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ Â«'+next.name+'Â»';
    if(pgs)pgs.textContent='ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ñ‚Ğµ ĞµÑ‰Ñ‘ '+(next.req-refs)+' Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞºĞ°';
  }else{
    setTimeout(()=>{const el=document.getElementById('pgfill');if(el)el.style.width='100%';},400);
    const pgt=document.getElementById('pgt');const pgs=document.getElementById('pgs');
    if(pgt)pgt.textContent='ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ!';
    if(pgs)pgs.textContent='Ğ’Ñ‹ Ğ² Ñ‚Ğ¾Ğ¿Ğµ Ğ°Ğ¼Ğ±Ğ°ÑÑĞ°Ğ´Ğ¾Ñ€Ğ¾Ğ² INVESTAT ğŸ†';
  }
}

function renderLevels(){
  const refs=CU?.refs||0;
  document.getElementById('lvlrow').innerHTML=LEVELS.map(l=>`
    <div class="lvlcard${refs>=l.req?' active':''}">
      <div class="lvl-e">${l.emoji}</div>
      <div class="lvl-n">${l.name}</div>
      <div class="lvl-r">${l.req===0?'Ğ¡Ñ‚Ğ°Ñ€Ñ‚':l.req+' Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°Ñˆ.'}</div>
    </div>`).join('');
}

// â•â•â•â• HOME â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderHome(){
  // Category cards
  document.getElementById('catg').innerHTML=Object.entries(CATS).map(([name,m])=>`
    <div class="ccard" style="background:${m.bg}" onclick="filterByCat('${name}')">
      <div class="ccard-ov"></div>
      <div class="ccard-ico"><svg width="36" height="36" viewBox="0 0 60 60"><use href="#${m.ico}" color="white"/></svg></div>
      <div class="ccard-body">
        <div class="ccard-cnt">${m.cnt} Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»${m.cnt>1&&m.cnt<5?'Ğ°':m.cnt===1?'':'Ğ¾Ğ²'}</div>
        <div class="ccard-name">${name}</div>
      </div>
    </div>`).join('');

  // Recent posts
  document.getElementById('recl').innerHTML = POSTS.slice(0,5).map(p => {
    const sid = String(p.id);
    return `<div class="rpost" onclick="openPost('${sid}')">
      <div class="rthumb" style="background:${p.bg}">
        <div class="rthumb-ico"><svg width="30" height="30" viewBox="0 0 60 60"><use href="#${p.ico}" color="white"/></svg></div>
      </div>
      <div class="ri">
        <div class="rt2">${p.title}</div>
        <div class="rm"><span class="badge ${bc(p.type)}">${tl(p.type)}</span><span style="font-size:11px;color:#7777aa">${p.cat}</span></div>
      </div>
    </div>`;
  }).join('');
}

// Search
let HFT2='all';
function onHS(){
  clearTimeout(HST);
  HST=setTimeout(()=>{
    const q=document.getElementById('hsi').value.trim().toLowerCase();
    const show=q||HFT2!=='all';
    document.getElementById('hsr').style.display=show?'':'none';
    document.getElementById('hdef').style.display=show?'none':'';
    if(show)renderPCards(document.getElementById('hsr'),fP(q,HFT2));
  },260);
}
function setHC(el,type){document.querySelectorAll('#hchips .chip').forEach(c=>c.classList.remove('on'));el.classList.add('on');HFT2=type;onHS();}
function filterByCat(cat){
  gt('home',document.querySelectorAll('.ntab')[0]);
  document.getElementById('hsi').value='';HFT2='all';
  document.querySelectorAll('#hchips .chip').forEach((c,i)=>c.classList.toggle('on',i===0));
  document.getElementById('hdef').style.display='none';
  document.getElementById('hsr').style.display='';
  renderPCards(document.getElementById('hsr'),POSTS.filter(p=>p.cat===cat));
}
function fP(q,type){return POSTS.filter(p=>{const mq=!q||(p.title+p.content+p.tags).toLowerCase().includes(q);return mq&&(type==='all'||p.type===type);});}

// â•â•â•â• POST CARDS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderPCards(el, posts){
  if(!posts.length){
    el.innerHTML=`<div class="empty"><div class="empt">ĞĞ¸Ñ‡ĞµĞ³Ğ¾ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾</div><div class="emps">ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ</div></div>`;
    return;
  }
  el.innerHTML = posts.map(p => {
    const sid = String(p.id);
    const fav = FAVS.has(sid);
    return `<div class="pcard" onclick="openPost('${sid}')">
      <div class="pcard-img" style="background:${p.bg}">
        <svg width="65" height="65" viewBox="0 0 60 60" style="position:relative;z-index:1"><use href="#${p.ico}" color="white"/></svg>
        <div class="pcard-img-ov"></div>
      </div>
      <div class="pcard-body">
        <div class="pcard-top">
          <div class="pcard-title">${p.title}</div>
          <button class="favbtn ${fav?'on':''}" onclick="event.stopPropagation();togFav('${sid}',this)" style="color:${fav?'#fbbf24':'#aaa'}">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="${fav?'#fbbf24':'none'}" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
          </button>
        </div>
        <div class="pcard-prev">${p.content}</div>
        <div class="pcard-foot">
          <span class="badge ${bc(p.type)}">${tl(p.type)}</span>
          ${(p.tags||'').split(',').filter(Boolean).slice(0,2).map(t=>`<span class="tag">#${t.trim()}</span>`).join('')}
        </div>
      </div>
    </div>`;
  }).join('');
}

// â•â•â•â• COLLECTIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderCollections(){
  const posts = POSTS.filter(p => FAVS.has(String(p.id)));
  const el = document.getElementById('colllist');
  if(!posts.length){
    el.innerHTML=`<div class="empty">
      <div style="width:64px;height:64px;border-radius:16px;background:linear-gradient(135deg,#0a1855,#1e3a8a);display:flex;align-items:center;justify-content:center;margin:0 auto 14px">
        <svg width="32" height="32" viewBox="0 0 60 60"><use href="#i-coin" color="white"/></svg>
      </div>
      <div class="empt">ĞŸĞ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸ Ğ¿ÑƒÑÑ‚Ñ‹</div>
      <div class="emps">ĞĞ°Ğ¶Ğ¼Ğ¸ Ğ½Ğ° Ğ·Ğ²ĞµĞ·Ğ´Ñƒ Ğ² Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ğµ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ</div>
    </div>`;return;
  }
  el.innerHTML = posts.map(p => {
    const sid = String(p.id);
    return `<div class="pcard" onclick="openPost('${sid}')">
      <div class="pcard-img" style="background:${p.bg}">
        <svg width="65" height="65" viewBox="0 0 60 60" style="position:relative;z-index:1"><use href="#${p.ico}" color="white"/></svg>
        <div class="pcard-img-ov"></div>
      </div>
      <div class="pcard-body">
        <div class="pcard-top">
          <div class="pcard-title">${p.title}</div>
          <button class="favbtn on" onclick="event.stopPropagation();togFav('${sid}',this)" style="color:#fbbf24">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="#fbbf24" stroke="#fbbf24" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
          </button>
        </div>
        <div class="pcard-prev">${p.content}</div>
        <div class="pcard-foot"><span class="badge ${bc(p.type)}">${tl(p.type)}</span></div>
      </div>
    </div>`;
  }).join('');
}

function togFav(id, btn){
  id = String(id);
  const was = FAVS.has(id);
  if(was){
    FAVS.delete(id);
    btn.style.color='#aaa';
    btn.innerHTML=`<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`;
    btn.classList.remove('on');
  } else {
    FAVS.add(id);
    btn.style.color='#fbbf24';
    btn.innerHTML=`<svg width="18" height="18" viewBox="0 0 24 24" fill="#fbbf24" stroke="#fbbf24" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`;
    btn.classList.add('on');
    showT('Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ² Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸');
  }
  if(CU){ svF(CU.id, FAVS); document.getElementById('acols').textContent = FAVS.size; }
  if(CID === id){ const sv=document.getElementById('dfsvg'); sv.setAttribute('fill',FAVS.has(id)?'#fbbf24':'none'); sv.setAttribute('stroke',FAVS.has(id)?'#fbbf24':'currentColor'); }
}

// â•â•â•â• LEADERBOARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderLBFallback(){
  // ĞŸĞ¾ĞºĞ° Firestore Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑÑ â€” Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ skeleton + Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
  const el = document.getElementById('lbd');
  if(!el) return;
  let html = '';
  // Ğ•ÑĞ»Ğ¸ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ĞµÑÑ‚ÑŒ â€” Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ ĞµĞ³Ğ¾ ÑÑ€Ğ°Ğ·Ñƒ
  if(CU){
    html += lbRow({id:CU.id, name:CU.name, username:CU.username||'', refs:CU.refs||0, col:CU.col}, 0, true);
  }
  // Skeleton ÑÑ‚Ñ€Ğ¾ĞºĞ¸
  for(let i=CU?1:0;i<5;i++){
    html += `<div class="lbi" style="opacity:.35">
      <div class="lbr rn">${i+(CU?2:1)}</div>
      <div class="lbav" style="background:#18182a"></div>
      <div class="lbn" style="background:#18182a;border-radius:6px;height:14px;width:120px;margin:4px 0"></div>
      <div class="lbs" style="background:#18182a;border-radius:6px;height:14px;width:24px"></div>
    </div>`;
  }
  el.innerHTML = html;
}

function lbRow(u, i, forceMe=false){
  const me = forceMe || (CU && u.id === CU.id);
  const rc = ['r1','r2','r3'][i] || 'rn';
  // ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¸Ğ¼Ñ + @username ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ
  const displayName = u.name || 'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¾Ñ€';
  const usernameTag = u.username ? `<span style="font-size:10px;color:#7777aa;margin-left:4px">@${u.username}</span>` : '';
  const meTag       = me ? `<span style="font-size:10px;color:var(--acc);margin-left:4px">(Ğ²Ñ‹)</span>` : '';
  return `<div class="lbi${me?' me':''}">
    <div class="lbr ${rc}">${i+1}</div>
    <div class="lbav" style="background:${u.col||AVCOLORS[i%AVCOLORS.length]}">${displayName[0].toUpperCase()}</div>
    <div style="flex:1;min-width:0">
      <div class="lbn${me?' me':''}" style="display:flex;align-items:center;flex-wrap:wrap;gap:2px">
        ${displayName}${usernameTag}${meTag}
      </div>
      <div style="font-size:10px;color:#7777aa;margin-top:1px">${u.refs||0} ${(u.refs||0)===1?'Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ğµ':'Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ğ¹'}</div>
    </div>
    <div class="lbs">${u.refs||0}</div>
  </div>`;
}

function renderLBData(arr){
  const el = document.getElementById('lbd');
  if(!el) return;
  if(!arr.length){
    el.innerHTML=`<div style="text-align:center;padding:24px;font-size:13px;color:#7777aa">Ğ ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ Ğ¿Ğ¾ĞºĞ° Ğ¿ÑƒÑÑ‚ â€” Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾!</div>`;
    return;
  }
  el.innerHTML = arr.map((u,i) => lbRow(u, i)).join('');
}

// â•â•â•â• POST DETAIL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openPost(id){
  id = String(id); // Ğ²ÑĞµĞ³Ğ´Ğ° ÑÑ‚Ñ€Ğ¾ĞºĞ°
  const p = POSTS.find(x => String(x.id) === id);
  if(!p) return;
  CID = id;
  document.getElementById('dhero').style.background = p.bg;
  document.getElementById('dhsvg').innerHTML = `<use href="#${p.ico}" color="white"/>`;
  document.getElementById('dht').textContent = p.title;
  document.getElementById('dbd').innerHTML = `<span class="badge ${bc(p.type)}">${tl(p.type)}</span><span style="margin-left:6px;font-size:11px;color:#7777aa">${p.cat}</span>`;
  document.getElementById('dtit').textContent = p.title;
  document.getElementById('dbody').textContent = p.content;
  document.getElementById('dtags').innerHTML = (p.tags||'').split(',').filter(Boolean).map(t=>`<span class="tag">#${t.trim()}</span>`).join('');
  document.getElementById('dwatch').href  = p.tgLink  || 'https://t.me/+c4ekMHlWBbQzYjUy';
  document.getElementById('dconsp').href  = p.tgConsp || 'https://t.me/+c4ekMHlWBbQzYjUy';
  const f = FAVS.has(id);
  const sv = document.getElementById('dfsvg');
  sv.setAttribute('fill',   f ? '#fbbf24' : 'none');
  sv.setAttribute('stroke', f ? '#fbbf24' : 'currentColor');
  document.getElementById('det').classList.add('show');
  document.getElementById('det').scrollTop = 0;
}
function closeDet(){ document.getElementById('det').classList.remove('show'); CID=null; renderCollections(); }
function togDF(){ if(CID===null)return; togFav(CID, document.getElementById('dfav')); }

// â•â•â•â• NAV â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function gt(name,el){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.ntab').forEach(t=>t.classList.remove('on'));
  document.getElementById('page-'+name).classList.add('active');
  el.classList.add('on');
  const T={home:'Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ',community:'Ğ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğµ',projects:'ĞŸÑ€Ğ¾ĞµĞºÑ‚Ñ‹',collections:'ĞŸĞ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸',ambassadors:'ĞĞ¼Ğ±Ğ°ÑÑĞ°Ğ´Ğ¾Ñ€Ñ‹'};
  document.getElementById('ptitle').textContent=T[name]||'';
  if(name==='collections') renderCollections();
  if(name==='ambassadors'){
    updateUI();
    renderLevels();
    loadLeaderboard();
  }
}

// â•â•â•â• UTILS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const bc=t=>({post:'b-post',video:'b-video',invest:'b-invest',case:'b-case',news:'b-news'}[t]||'b-post');
const tl=t=>({post:'ĞŸĞ¾ÑÑ‚',video:'Ğ’Ğ¸Ğ´ĞµĞ¾',invest:'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸',case:'ĞšĞµĞ¹Ñ',news:'ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸'}[t]||t);
function ol(u){window.open(u,'_blank');}
// SVG Ğ¸ĞºĞ¾Ğ½ĞºĞ¸ Ğ´Ğ»Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¹ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸
const SVG_COPY = `<rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>`;
const SVG_CHECK = `<polyline points="20 6 9 17 4 12"/>`;

function animateCopyBtn(btnId, icoId, txtId, svgId, success){
  const ico = document.getElementById(icoId);
  const txt = document.getElementById(txtId);
  const svg = document.getElementById(svgId);
  if(!ico) return;
  if(success){
    ico.style.cssText+='background:rgba(11,170,110,.15)!important;border-color:rgba(11,170,110,.4)!important;color:#34d399!important';
    if(svg) svg.innerHTML = SVG_CHECK;
    if(txt) txt.textContent = 'Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!';
    setTimeout(()=>{
      ico.style.cssText=ico.style.cssText.replace(/background[^;]+;|border-color[^;]+;|color[^;]+;/g,'');
      ico.style.color='#7777aa';
      if(svg) svg.innerHTML = SVG_COPY;
      if(txt) txt.textContent = 'ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ';
    }, 2000);
  } else {
    if(txt) txt.textContent = 'Ğ’Ñ€ÑƒÑ‡Ğ½ÑƒÑ :(';
    setTimeout(()=>{ if(txt) txt.textContent='ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ'; }, 1500);
  }
}

function doCopy(text, onDone){
  if(navigator.clipboard && navigator.clipboard.writeText){
    navigator.clipboard.writeText(text).then(()=>onDone(true)).catch(()=>{
      // Ğ¤Ğ¾Ğ»Ğ»Ğ±ÑĞº Ğ´Ğ»Ñ Telegram WebApp
      try{
        const el=document.createElement('textarea');
        el.value=text; el.style.cssText='position:fixed;opacity:0;top:0;left:0';
        document.body.appendChild(el); el.focus(); el.select();
        const ok = document.execCommand('copy');
        document.body.removeChild(el);
        onDone(ok);
      }catch(e){ onDone(false); }
    });
  } else {
    try{
      const el=document.createElement('textarea');
      el.value=text; el.style.cssText='position:fixed;opacity:0;top:0;left:0';
      document.body.appendChild(el); el.focus(); el.select();
      const ok = document.execCommand('copy');
      document.body.removeChild(el);
      onDone(ok);
    }catch(e){ onDone(false); }
  }
}

function cpRef(){
  const refId = CU?.tgNumericId || String(CU?.id||'').replace('tg','');
  // ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ´Ğ»Ñ Telegram Mini App Ñ‡ĞµÑ€ĞµĞ· inline ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ±Ğ¾Ñ‚Ğ°
  const rl = 'https://t.me/navigationinvestat_bot?start=ref_' + refId;
  doCopy(rl, ok => animateCopyBtn('reflbtn','reflico','refltxt','reflsvg', ok));
}
function cpHR(){
  const refId = CU?.tgNumericId || String(CU?.id||'').replace('tg','');
  const rl = 'https://t.me/navigationinvestat_bot?start=ref_' + refId;
  doCopy(rl, ok => animateCopyBtn('hcpbtn','hcpbtn','hcptxt','hcpico', ok));
}
function showT(m){const t=document.getElementById('toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2400);}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ADMIN PANEL
// Ğ¢Ğ²Ğ¾Ğ¹ Telegram ID: 5996401983
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ADMIN_IDS = [
  'tg5996401983', '5996401983',   // Ñ‚Ñ‹
  'tg240326047',  '240326047'     // Ğ¿Ğ°Ğ¿Ğ°
];

function isAdmin(){
  if(!CU) return false;
  const rawId = String(CU.id).replace('tg','');
  return ADMIN_IDS.some(a => a === CU.id || a === rawId);
}

function checkAdminFab(){
  const fab = document.getElementById('admin-fab');
  if(fab) fab.style.display = isAdmin() ? 'flex' : 'none';
}

function openAdmin(){
  document.getElementById('admin-panel').style.display='block';
  admTab('posts', document.getElementById('atab-posts'));
}

function closeAdmin(){
  document.getElementById('admin-panel').style.display='none';
}

function admTab(name, el){
  document.querySelectorAll('.adm-tab').forEach(t=>t.classList.remove('on'));
  el.classList.add('on');
  document.getElementById('adm-posts').style.display = name==='posts' ? 'block' : 'none';
  document.getElementById('adm-users').style.display = name==='users' ? 'block' : 'none';
  if(name==='posts')  admLoadPosts();
  if(name==='users')  admLoadUsers();
}

// â”€â”€ POSTS ADMIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const CAT_TYPES = {
  'Ğ˜Ğ½Ğ²ĞµÑÑ‚Ğ¸Ñ†Ğ¸Ğ¸':'invest','ĞšĞµĞ¹ÑÑ‹':'case','Ğ’Ğ¸Ğ´ĞµĞ¾':'video',
  'ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°':'post','ĞĞ¾Ğ²Ğ¾ÑÑ‚Ğ¸':'news','ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ':'post'
};

function admAddPost(){
  const title   = document.getElementById('ap-title').value.trim();
  const content = document.getElementById('ap-content').value.trim();
  const cat     = document.getElementById('ap-cat').value;
  const type    = document.getElementById('ap-type').value;
  const tags    = document.getElementById('ap-tags').value.trim();
  const link    = document.getElementById('ap-link').value.trim() || 'https://t.me/+c4ekMHlWBbQzYjUy';
  const order   = parseInt(document.getElementById('ap-order').value) || (POSTS.length + 1);

  if(!title){ showT('âš ï¸ Ğ’Ğ²ĞµĞ´Ğ¸ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº'); return; }
  if(!content){ showT('âš ï¸ Ğ’Ğ²ĞµĞ´Ğ¸ Ñ‚ĞµĞºÑÑ‚ Ğ¿Ğ¾ÑÑ‚Ğ°'); return; }
  if(!window.__firebaseReady){ showT('âŒ Firestore Ğ½Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ñ‘Ğ½'); return; }

  const meta = CAT_META[cat] || {ico:'i-coin', bg:'linear-gradient(135deg,#0a1855,#1e3a8a)'};
  const btn  = document.querySelector('#adm-posts .adm-btn');
  const resetBtn = () => {
    btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg> ĞĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ÑÑ‚';
    btn.disabled = false;
    btn.style.opacity = '';
  };
  btn.textContent = 'â³ ĞŸÑƒĞ±Ğ»Ğ¸ĞºÑƒÑ...';
  btn.disabled = true;
  btn.style.opacity = '0.7';

  // â˜… Ğ˜Ğ¡ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ: Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ addDoc â€” Ğ¾Ğ½ ÑĞ°Ğ¼ ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ID
  window.__fsAddDoc(window.__fsCollection(window.__FS, 'posts'), {
    title, content, cat, type, tags,
    ico: meta.ico, bg: meta.bg,
    tgLink: link, tgConsp: link,
    order, published: true,
    createdAt: window.__fsTs(),
    createdBy: CU?.id || 'admin'
  })
  .then(()=>{
    showT('âœ… ĞŸĞ¾ÑÑ‚ Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ğ½!');
    ['ap-title','ap-content','ap-tags','ap-order'].forEach(id=>{
      const el = document.getElementById(id);
      if(el) el.value = '';
    });
    resetBtn();
    admLoadPosts();
  })
  .catch(e=>{
    showT('âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: ' + e.message);
    resetBtn();
  });
}

function admLoadPosts(){
  if(!window.__firebaseReady){ document.getElementById('adm-posts-list').innerHTML='<div style="color:#7777aa;font-size:13px">Firestore Ğ½Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ñ‘Ğ½</div>'; return; }
  const el = document.getElementById('adm-posts-list');
  el.innerHTML = '<div style="color:#7777aa;font-size:13px;padding:8px 0">Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...</div>';
  window.__fsGetDocs(window.__fsCollection(window.__FS,'posts')).then(snap=>{
    if(snap.empty){ el.innerHTML='<div style="color:#7777aa;font-size:13px;padding:8px 0">ĞŸĞ¾ÑÑ‚Ğ¾Ğ² Ğ¿Ğ¾ĞºĞ° Ğ½ĞµÑ‚ â€” ÑĞ¾Ğ·Ğ´Ğ°Ğ¹ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ²Ñ‹ÑˆĞµ</div>'; return; }
    const posts = [];
    snap.forEach(d=>posts.push({docId:d.id, ...d.data()}));
    posts.sort((a,b)=>(a.order||99)-(b.order||99));
    el.innerHTML = posts.map(p=>{
      const hidden = p.published === false;
      return `<div class="adm-post-item" style="${hidden?'opacity:.5':''}">
        <div style="width:36px;height:36px;border-radius:8px;flex-shrink:0;background:${p.bg||'#111'};display:flex;align-items:center;justify-content:center">
          <svg width="20" height="20" viewBox="0 0 60 60"><use href="#${p.ico||'i-coin'}" color="white"/></svg>
        </div>
        <div style="flex:1;min-width:0">
          <div style="font-size:13px;font-weight:600;color:#eeeeff;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">
            ${hidden?'<span style="font-size:10px;background:rgba(224,48,80,.2);color:#ff8099;padding:1px 5px;border-radius:4px;margin-right:5px">ÑĞºÑ€Ñ‹Ñ‚</span>':''}${p.title||'â€”'}
          </div>
          <div style="font-size:11px;color:#7777aa;margin-top:2px">${p.cat||''} Â· Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº: ${p.order||'â€”'}</div>
        </div>
        <div style="display:flex;gap:6px;flex-shrink:0">
          ${hidden
            ? `<button onclick="admRestorePost('${p.docId}')" style="width:30px;height:30px;border-radius:8px;background:rgba(11,170,110,.15);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#34d399;font-size:14px">ğŸ‘</button>`
            : `<button onclick="admDeletePost('${p.docId}')" style="width:30px;height:30px;border-radius:8px;background:rgba(224,48,80,.1);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#e03050">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14H6L5 6"/><path d="M10 11v6m4-6v6"/></svg>
              </button>`
          }
        </div>
      </div>`;
    }).join('');
  }).catch(e=>{ el.innerHTML=`<div style="color:#e03050;font-size:13px">${e.message}</div>`; });
}

function admRestorePost(docId){
  window.__fsUpdateDoc(window.__fsDoc(window.__FS,'posts',docId),{published:true})
    .then(()=>{ showT('âœ… ĞŸĞ¾ÑÑ‚ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½'); admLoadPosts(); })
    .catch(e=>showT('ĞÑˆĞ¸Ğ±ĞºĞ°: '+e.message));
}

function admDeletePost(docId){
  // confirm() Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ² Telegram Mini App â€” Ğ´ĞµĞ»Ğ°ĞµĞ¼ ÑĞ²Ğ¾Ğ¹ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³
  const overlay = document.createElement('div');
  overlay.style.cssText='position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;box-sizing:border-box';
  overlay.innerHTML=`<div style="background:#1a1a2e;border-radius:16px;padding:24px;max-width:300px;width:100%;text-align:center;border:1px solid rgba(255,255,255,.1)">
    <div style="font-size:32px;margin-bottom:12px">ğŸ—‘</div>
    <div style="font-size:15px;font-weight:700;color:#eeeeff;margin-bottom:8px">Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾ÑÑ‚?</div>
    <div style="font-size:12px;color:#7777aa;margin-bottom:20px">ĞŸĞ¾ÑÑ‚ Ğ±ÑƒĞ´ĞµÑ‚ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½ Ğ±ĞµĞ·Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ½Ğ¾</div>
    <div style="display:flex;gap:10px">
      <button onclick="this.closest('.del-overlay').remove()" style="flex:1;padding:12px;background:#111122;border:1px solid rgba(255,255,255,.1);border-radius:10px;color:#aaa;font-size:13px;font-weight:600;cursor:pointer;font-family:Manrope">ĞÑ‚Ğ¼ĞµĞ½Ğ°</button>
      <button id="del-ok-${docId}" style="flex:1;padding:12px;background:linear-gradient(135deg,#e03050,#c02040);border:none;border-radius:10px;color:#fff;font-size:13px;font-weight:700;cursor:pointer;font-family:Manrope">Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ</button>
    </div>
  </div>`;
  overlay.classList.add('del-overlay');
  document.body.appendChild(overlay);
  document.getElementById('del-ok-'+docId).onclick = () => {
    overlay.remove();
    window.__fsDeleteDoc(window.__fsDoc(window.__FS,'posts',docId))
      .then(()=>{ showT('ğŸ—‘ ĞŸĞ¾ÑÑ‚ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½'); admLoadPosts(); })
      .catch(e=>showT('ĞÑˆĞ¸Ğ±ĞºĞ°: '+e.message));
  };
}

// â”€â”€ USERS ADMIN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function admLoadUsers(){
  if(!window.__firebaseReady){ document.getElementById('adm-users-list').innerHTML='<div style="color:#7777aa;font-size:13px">Firestore Ğ½Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ñ‘Ğ½</div>'; return; }
  const el = document.getElementById('adm-users-list');
  el.innerHTML = '<div style="color:#7777aa;font-size:13px;padding:8px 0">Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...</div>';
  window.__fsGetDocs(window.__fsCollection(window.__FS,'users')).then(snap=>{
    if(snap.empty){ el.innerHTML='<div style="color:#7777aa;font-size:13px">ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ğ¿Ğ¾ĞºĞ° Ğ½ĞµÑ‚</div>'; return; }
    const users = [];
    snap.forEach(d=>users.push({docId:d.id,...d.data()}));
    users.sort((a,b)=>(b.refs||0)-(a.refs||0));
    el.innerHTML = users.map(u=>{
      const blocked = u.blocked || false;
    const tgNumericId = String(u.docId).replace('tg','');
      const isAdminUser = ADMIN_IDS.some(id=>id===u.docId||id===tgNumericId);
      const isMe = tgNumericId === '5996401983';
      return `<div class="adm-user-item">
        <div class="adm-user-row">
          <div class="adm-user-av" style="background:${u.col||'#3d5af1'}">${(u.name||'?')[0].toUpperCase()}</div>
          <div class="adm-user-info">
            <div class="adm-user-name">
              ${u.name||'â€”'}
              ${isMe?'<span style="font-size:10px;background:rgba(61,90,241,.2);color:#818cf8;padding:2px 6px;border-radius:5px;margin-left:4px">Ğ’Ğ«</span>':''}
              ${isAdminUser&&!isMe?'<span style="font-size:10px;background:rgba(99,102,241,.2);color:#a5b4fc;padding:2px 6px;border-radius:5px;margin-left:4px">ADMIN</span>':''}
              ${blocked?'<span class="blocked-badge">Ğ—ĞĞ‘Ğ›ĞĞšĞ˜Ğ ĞĞ’ĞĞ</span>':''}
            </div>
            <div class="adm-user-meta">${u.username?'@'+u.username+' Â· ':''} ${u.email||''}</div>
          </div>
          ${!isMe?
            `<button class="adm-block-btn ${blocked?'unblock':'block'}" onclick="admToggleBlock('${u.docId}',${blocked})">
              ${blocked?'âœ… Ğ Ğ°Ğ·Ğ±Ğ»Ğ¾Ğº':'ğŸš« Ğ‘Ğ»Ğ¾Ğº'}
            </button>`
          :''}
        </div>
        <div class="adm-user-stats">
          <span class="adm-stat">ğŸ‘¥ Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»Ñ‹: <b>${u.refs||0}</b></span>
          <span class="adm-stat">â­ Ğ‘Ğ°Ğ»Ğ»Ñ‹: <b>${u.pts||0}</b></span>
          <span class="adm-stat">ğŸ“± ${u.platform||'â€”'}</span>
        </div>
        <div style="margin-top:8px;padding:8px 10px;background:rgba(255,255,255,.04);border-radius:8px">
          <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:6px">
            <div>
              <div style="font-size:10px;color:#7777aa;margin-bottom:2px">Telegram ID</div>
              <div style="font-size:13px;font-weight:700;color:#818cf8;font-family:monospace">${tgNumericId}</div>
            </div>
            <div>
              <div style="font-size:10px;color:#7777aa;margin-bottom:2px">ID Ğ² Ğ±Ğ°Ğ·Ğµ</div>
              <div style="font-size:11px;font-weight:600;color:#aaaacc;font-family:monospace">${u.docId}</div>
            </div>
            <div>
              <div style="font-size:10px;color:#7777aa;margin-bottom:2px">Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½</div>
              <div style="font-size:12px;color:#eeeeff">${u.phone||'â€”'}</div>
            </div>
            <a href="https://t.me/${u.username?u.username:'id'+tgNumericId}" target="_blank" style="padding:6px 10px;background:rgba(61,90,241,.2);border-radius:8px;color:#818cf8;font-size:11px;font-weight:700;text-decoration:none;white-space:nowrap">âœ‰ï¸ ĞĞ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ</a>
          </div>
          ${!isMe?`<button onclick="admAddRefManual('${u.docId}','${(u.name||'').replace(/'/g,"")}')" style="width:100%;padding:7px;background:rgba(61,90,241,.15);border:1px solid rgba(61,90,241,.3);border-radius:8px;color:#818cf8;font-size:11px;font-weight:600;cursor:pointer;font-family:Manrope">+ Ğ—Ğ°Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ» Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ</button>`:''}
        </div>
        <div style="font-size:10px;color:#555;margin-top:4px">${u.lastSeen?'Ğ’Ñ…Ğ¾Ğ´: '+new Date(u.lastSeen).toLocaleString('ru'):''}</div>
      </div>`;
    }).join('');
  }).catch(e=>{ el.innerHTML=`<div style="color:#e03050;font-size:13px">${e.message}</div>`; });
}

function admToggleBlock(docId, currentlyBlocked){
  const ref = window.__fsDoc(window.__FS, 'users', docId);
  window.__fsUpdateDoc(ref, {blocked: !currentlyBlocked}).then(()=>{
    showT(currentlyBlocked ? 'âœ… Ğ Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½' : 'ğŸš« Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½');
    admLoadUsers();
  }).catch(e=>showT('ĞÑˆĞ¸Ğ±ĞºĞ°: '+e.message));
}

// â˜… Ğ ÑƒÑ‡Ğ½Ğ¾Ğµ Ğ·Ğ°Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ° (Ğ´Ğ»Ñ ÑƒĞ¶Ğµ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ñ€ÑƒĞ·ĞµĞ¹)
function admAddRefManual(toDocId, toName){
  const overlay = document.createElement('div');
  overlay.style.cssText='position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;box-sizing:border-box';
  overlay.innerHTML=`<div style="background:#1a1a2e;border-radius:16px;padding:24px;max-width:320px;width:100%;border:1px solid rgba(255,255,255,.1)">
    <div style="font-size:14px;font-weight:700;color:#eeeeff;margin-bottom:4px">Ğ—Ğ°Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»</div>
    <div style="font-size:12px;color:#7777aa;margin-bottom:16px">ĞšĞ¾Ğ¼Ñƒ Ğ½Ğ°Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ: <b style="color:#818cf8">${toName}</b></div>
    <div style="font-size:12px;color:#7777aa;margin-bottom:6px">Telegram ID Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ²ÑˆĞµĞ³Ğ¾:</div>
    <input id="ref-manual-id" placeholder="5996401983" style="width:100%;background:#111122;border:1px solid rgba(255,255,255,.15);border-radius:10px;padding:10px 12px;color:#eeeeff;font-size:13px;font-family:Manrope;outline:none;box-sizing:border-box;margin-bottom:16px">
    <div style="display:flex;gap:10px">
      <button onclick="this.closest('.ref-overlay').remove()" style="flex:1;padding:11px;background:#111122;border:1px solid rgba(255,255,255,.1);border-radius:10px;color:#aaa;font-size:13px;cursor:pointer;font-family:Manrope">ĞÑ‚Ğ¼ĞµĞ½Ğ°</button>
      <button id="ref-manual-ok" style="flex:1;padding:11px;background:linear-gradient(135deg,#3d5af1,#6366f1);border:none;border-radius:10px;color:#fff;font-size:13px;font-weight:700;cursor:pointer;font-family:Manrope">Ğ—Ğ°Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ÑŒ</button>
    </div>
  </div>`;
  overlay.classList.add('ref-overlay');
  document.body.appendChild(overlay);
  document.getElementById('ref-manual-ok').onclick = () => {
    const invId = document.getElementById('ref-manual-id').value.trim();
    if(!invId){ showT('âš ï¸ Ğ’Ğ²ĞµĞ´Ğ¸ ID'); return; }
    overlay.remove();
    fsAddRef(invId, toDocId);
    showT('ğŸ¯ Ğ ĞµÑ„ĞµÑ€Ğ°Ğ» Ğ·Ğ°Ñ‡Ğ¸ÑĞ»ÑĞµÑ‚ÑÑ...');
  };
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸ Ğ¿Ñ€Ğ¸ Ğ»Ğ¾Ğ³Ğ¸Ğ½Ğµ
async function checkBlocked(userId){
  if(!window.__firebaseReady) return false;
  try{
    const snap = await window.__fsGetDoc(window.__fsDoc(window.__FS,'users',String(userId)));
    return snap.exists() && snap.data().blocked === true;
  }catch(e){ return false; }
}

// ĞĞ²Ñ‚Ğ¾Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ admin fab Ğ¿Ñ€Ğ¸ launch
</script>
</body>
</html>
